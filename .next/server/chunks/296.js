exports.id=296,exports.ids=[296],exports.modules={62172:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62172,e.exports=t},22395:(e,t,s)=>{Promise.resolve().then(s.bind(s,9131)),Promise.resolve().then(s.t.bind(s,92481,23)),Promise.resolve().then(s.t.bind(s,79404,23)),Promise.resolve().then(s.t.bind(s,98684,23)),Promise.resolve().then(s.bind(s,85999)),Promise.resolve().then(s.bind(s,19665)),Promise.resolve().then(s.bind(s,16043)),Promise.resolve().then(s.bind(s,48221)),Promise.resolve().then(s.bind(s,45086)),Promise.resolve().then(s.bind(s,89217)),Promise.resolve().then(s.bind(s,14295)),Promise.resolve().then(s.bind(s,10613)),Promise.resolve().then(s.bind(s,68132)),Promise.resolve().then(s.bind(s,47132)),Promise.resolve().then(s.bind(s,52116)),Promise.resolve().then(s.bind(s,35209)),Promise.resolve().then(s.bind(s,28003)),Promise.resolve().then(s.bind(s,13294)),Promise.resolve().then(s.bind(s,10006)),Promise.resolve().then(s.bind(s,3952)),Promise.resolve().then(s.bind(s,38911)),Promise.resolve().then(s.bind(s,47112)),Promise.resolve().then(s.bind(s,68813)),Promise.resolve().then(s.bind(s,26733)),Promise.resolve().then(s.bind(s,88313)),Promise.resolve().then(s.bind(s,59805)),Promise.resolve().then(s.bind(s,66009)),Promise.resolve().then(s.bind(s,79951)),Promise.resolve().then(s.bind(s,46714)),Promise.resolve().then(s.bind(s,71131)),Promise.resolve().then(s.bind(s,69312)),Promise.resolve().then(s.bind(s,54476)),Promise.resolve().then(s.bind(s,90572)),Promise.resolve().then(s.bind(s,56299)),Promise.resolve().then(s.bind(s,1001)),Promise.resolve().then(s.bind(s,59020))},53303:(e,t,s)=>{Promise.resolve().then(s.bind(s,9131)),Promise.resolve().then(s.t.bind(s,92481,23)),Promise.resolve().then(s.t.bind(s,79404,23)),Promise.resolve().then(s.bind(s,85999)),Promise.resolve().then(s.bind(s,19665)),Promise.resolve().then(s.bind(s,16043)),Promise.resolve().then(s.bind(s,45086)),Promise.resolve().then(s.bind(s,89217)),Promise.resolve().then(s.bind(s,14295)),Promise.resolve().then(s.bind(s,10613)),Promise.resolve().then(s.bind(s,68132)),Promise.resolve().then(s.bind(s,47132)),Promise.resolve().then(s.bind(s,52116)),Promise.resolve().then(s.bind(s,35209)),Promise.resolve().then(s.bind(s,28003)),Promise.resolve().then(s.bind(s,13294)),Promise.resolve().then(s.bind(s,10006)),Promise.resolve().then(s.bind(s,3952)),Promise.resolve().then(s.bind(s,38911)),Promise.resolve().then(s.bind(s,47112)),Promise.resolve().then(s.bind(s,68813)),Promise.resolve().then(s.bind(s,26733)),Promise.resolve().then(s.bind(s,88313)),Promise.resolve().then(s.bind(s,59805)),Promise.resolve().then(s.bind(s,66009)),Promise.resolve().then(s.bind(s,79951))},56353:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},34654:(e,t,s)=>{"use strict";s.d(t,{w:()=>a,s:()=>r});var r=s(16043),a=s(19665)},48221:(e,t,s)=>{"use strict";s.r(t),s.d(t,{EditSelfieForm:()=>W});var r=s(10326),a=s(35047),n=s(17577),l=s(85999),o=s(16106),i=s(11220),c=s(16254),d=s(64620),u=s(57451),h=s(4764),m=s(59732),f=s(11437),x=s(24719),p=s(52664),g=s(62424),v=s(40480),j=s(48029),y=s.n(j);let w=()=>{let{api:e}=(0,o.Rv)(),{data:t,setSelfieData:s}=(0,o.dV)(),[a,c]=(0,n.useState)(t.selfie.url||t.selfie.hash),[d,u]=(0,n.useState)(void 0),h=(0,n.useRef)();return(0,r.jsxs)("div",{className:y()("fric text-xs subtle-hover",{"!text-red-500":d},{"!text-green-500":!1===d}),children:[(0,r.jsxs)("span",{children:["https://travel.kupfer.es","/s/"]}),r.jsx("input",{value:a,onChange:r=>{clearTimeout(h.current);let a=(r.target.value??"").trim();if(c(a),0===a.length||a===t.selfie.hash){u(void 0);return}a.length<5||(h.current=setTimeout(()=>{e({url:"/api/check-url",body:{hash:t.selfie.hash,url:a}}).then(i.xO).then(e=>{s({...t.selfie,url:a}),u(!1)}).catch(e=>{u(!0),s({url:void 0}),l.toast.error(String(e))})},1e3))},className:"bg-transparent text-xs border-none w-16 outline-none focus:outline-none",placeholder:t.selfie.hash})]})};var b=s(10058),A=s(10474);let S=({disabled:e=!1,acceptTypes:t=A.HW,onFileAdded:s,isUploading:a=!1,children:o,className:c=""})=>{let[d,u]=(0,n.useState)(!1),h=(0,n.useCallback)(e=>{m(!1),e?.length?s(e):l.toast.error("You didn't add any files")},[s]),m=(0,n.useCallback)(e=>{u(e)},[]);return(0,r.jsxs)("label",{className:y()("border-2 border-dashed group cursor-pointer rounded-lg w-full items-center flex justify-center p-4 transition-colors h-full aspect-[4/3]",d?"border-purple-300/30 bg-purple-300/20":"hover:bg-pulze-200",(0,i.Ij)({loading:a,spinner:!0}),c),"data-loading":"uploading...",onDragEnter:()=>{m(!0)},onDragLeave:()=>{m(!1)},onDragEnd:()=>{m(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),m(!0)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),h(e.dataTransfer.files)},children:[o,r.jsx("input",{disabled:e,type:"file",onChange:e=>h(e.target.files),accept:t?Object.keys(t).join(","):"*",className:"fixed -left-[10000px] h-0 w-0"})]})},N=(e,t,s=!1)=>({...e,lat:t.lat||e.lat,lng:t.lng||e.lng,place:s?(0,i.r7)(t):e.place||(0,i.r7)(t)}),E=(e,t)=>{let s=new FileReader;s.onloadend=()=>{let e=new Image;e.addEventListener("load",function(){t(s.result)}),e.src=s.result},s.readAsDataURL(e)},P=({className:e="",onUseImage:t,onUploadComplete:s})=>{let{api:a}=(0,o.Rv)(),{data:c,hash:d}=(0,o.dV)(),[u,h]=(0,n.useState)(c.attachments);return(0,r.jsxs)(r.Fragment,{children:[r.jsx(S,{onFileAdded:e=>{let t=e[0];if(!t?.type.startsWith("image/")){l.toast.error("Invalid image type!");return}let r=prompt("Name for the file?",t.name)??t.name;E(t,e=>{h(e=>[...e,null]);let n=new FormData;n.append("_file_",t),n.append("hash",d),n.append("type",r);let o=a({method:"POST",body:n,url:"/api/imageupload",contentType:!1}).then(i.xO).then(e=>(h(t=>(t.pop(),[...t,e.src])),s?.(e.src),e));l.toast.promise(o,{success:e=>e.message,error:e=>e.message})})},className:e,children:null===(0,i.jA)(u)?(0,r.jsxs)("div",{className:"text-inset-shadow text-sm fric space-x-2",children:[r.jsx("span",{children:"Uploading..."}),r.jsx(b.Z,{className:"size-4 animate-pulse"})]}):r.jsx("div",{className:"text-inset-shadow text-sm",children:"Drop an image to add it to the description"})}),r.jsx("div",{className:"flex flex-col space-y-2 py-4",children:u.map(e=>e?(0,r.jsxs)("a",{role:"button",onClick:()=>t(e),className:"fric space-x-4 cursor-pointer",children:[r.jsx("div",{className:"aspect-square h-16 bg-no-repeat bg-center bg-cover rounded-full",style:{backgroundImage:`url(${"https://travel-api.kupfer.es"+e})`}}),r.jsx("pre",{className:"text-secondary",children:e.split("/attachment_").pop()})]},e):null)})]})};s(70499),s(45735),s(76433);var _=s(79810);let C=(0,n.forwardRef)(function({readOnly:e,defaultValue:t,onTextChange:s,onSelectionChange:a},l){let o=(0,n.useRef)(null),i=(0,n.useRef)(t),c=(0,n.useRef)(s),d=(0,n.useRef)(a);return(0,n.useLayoutEffect)(()=>{c.current=s,d.current=a}),(0,n.useEffect)(()=>{l?.current?.enable(!e)},[l,e]),(0,n.useEffect)(()=>{let e=o.current,t=e.appendChild(e.ownerDocument.createElement("div")),s=new _.ZP(t,{theme:"snow",modules:{toolbar:["bold","italic","underline"]}});return l.current=s,i.current&&s.clipboard.dangerouslyPasteHTML(i.current,"api"),s.on(_.ZP.events.TEXT_CHANGE,(...e)=>{c.current?.(...e)}),s.on(_.ZP.events.SELECTION_CHANGE,(...e)=>{d.current?.(...e)}),()=>{l.current=null,e.innerHTML=""}},[l]),r.jsx("div",{ref:o})}),D=({error:e,onChange:t,value:s})=>{let a=(0,n.useRef)(),[l,o]=(0,n.useState)([0,0]),i=(0,n.useRef)(null),c=e=>{a.current.insertEmbed(l[0],"image",`https://travel-api.kupfer.es${e}`)};return(0,r.jsxs)(m.Z,{error:!!e,children:[r.jsx(f.Z,{children:"description"}),r.jsx(C,{ref:a,defaultValue:s,onSelectionChange:(e,t)=>{t?o([t.index,t.index+t.length]):o([0,0])},onTextChange:()=>{clearTimeout(i.current),i.current=setTimeout(()=>{t(a.current.getSemanticHTML())},300)}}),e&&r.jsx(p.Z,{children:e}),r.jsx("br",{}),r.jsx(P,{className:"!h-24",onUseImage:c,onUploadComplete:c})]})};var k=s(56814),O=s(56873),z=s(11055),Z=s(8686),T=s(99883),M=s(54553);let F={access_token:"pk.eyJ1Ijoibmljb2pvbmVzIiwiYSI6ImNqYjhvejQxNjA1eXkzMm9mcTljanBubGcifQ.WM7Ry1e1-1liibdD7PSNsA",session_token:(0,i.HP)()},R=({onUpdateCoords:e})=>{let{data:t}=(0,o.dV)(),[s,a]=(0,n.useState)([]),c=(0,n.useRef)(null),d=e=>{clearTimeout(c.current),c.current=setTimeout(()=>{e.length<3||fetch(`https://api.mapbox.com/search/searchbox/v1/suggest${(0,i.L7)({q:e,...F})}`).then(e=>e.json()).then(e=>{a(e.suggestions)}).catch(e=>{l.toast.error(String(e))})},300)},u=s=>{if(null===s||"string"==typeof s)return;let r={...F,...t.selfie.lat&&t.selfie.lng?{proximity:`${t.selfie.lng},${t.selfie.lat}`}:{}};fetch(`https://api.mapbox.com/search/searchbox/v1/retrieve/${s.mapbox_id}${(0,i.L7)(r)}`).then(e=>e.json()).then(t=>{let[s,r]=t.features[0].geometry.coordinates;e(t.features[0].properties.full_address,{lat:r,lng:s})}).catch(e=>{l.toast.error(String(e))})};return r.jsx(r.Fragment,{children:r.jsx(z.Z,{inputValue:t.selfie.place,onInputChange:(t,s)=>{d(s),e(s)},options:s,autoHighlight:!0,onChange:(e,t)=>u(t),freeSolo:!0,getOptionLabel:e=>"string"==typeof e?e:e.name,getOptionKey:e=>"string"==typeof e?e:e.mapbox_id,renderOption:(e,t)=>(0,r.jsxs)(Z.Z,{...e,children:[r.jsx(T.Z,{children:"poi"===t.feature_type?r.jsx(k.Z,{className:"size-4"}):r.jsx(O.Z,{className:"size-4"})}),(0,r.jsxs)(M.Z,{children:[t.name,r.jsx(h.ZP,{level:"body-xs",children:t.place_formatted})]})]})})})},$=({onSubmit:e})=>{let{api:t}=(0,o.Rv)(),{data:s,errors:l,setSelfieData:c,hasImages:j,markers:y}=(0,o.dV)(),b=(0,a.useRouter)(),A=j?.me?s.images.me.date:s.images.lc.date,S=e=>t=>c({[e]:t.target.value}),N=(0,n.useCallback)((e,t)=>{c({place:e,...t??{}})},[s]);return j?(0,r.jsxs)("form",{className:"flex flex-col space-y-10",onSubmit:t=>{t.preventDefault(),e()},children:[(0,r.jsxs)("div",{className:"flex flex-col space-y-10 lg:flex-row lg:space-x-10 lg:space-y-0 items-start",children:[(0,r.jsxs)("div",{className:"flex flex-col space-y-10 flex-1 w-full",children:[(0,r.jsxs)(m.Z,{error:!!l.title,children:[(0,r.jsxs)(f.Z,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:[r.jsx("span",{children:"title"}),r.jsx(w,{})]}),r.jsx(x.ZP,{value:s.selfie.title,onChange:S("title")}),l.title&&r.jsx(p.Z,{children:l.title})]}),(0,r.jsxs)(m.Z,{error:!!l.subtitle,children:[r.jsx(f.Z,{children:"some words"}),r.jsx(x.ZP,{value:s.selfie.subtitle,onChange:S("subtitle")}),l.subtitle&&r.jsx(p.Z,{children:l.subtitle})]})]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-10 flex-1 w-full",children:[(0,r.jsxs)(m.Z,{error:!!l.date,children:[(0,r.jsxs)(f.Z,{sx:{width:"100%",display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{children:"date"}),(0,r.jsxs)("span",{className:"fric space-x-4 subtle-hover",children:[A&&r.jsx("a",{role:"button",className:"cursor-pointer hover:underline",onClick:()=>{let e=1970===new Date(A).getFullYear()?1e3:1,t=new Date(Number(A)*e).toISOString().split("T")[0];console.log("Using picture's date: ",A,t),c({date:t})},children:"from picture"}),r.jsx("a",{role:"button",className:"cursor-pointer hover:underline",onClick:()=>c({date:new Date().toISOString().split("T")[0]}),children:"today"})]})]}),r.jsx(x.ZP,{value:s.selfie.date,onChange:S("date"),type:"date",sx:{textAlign:"left"}}),l.date&&r.jsx(p.Z,{children:l.date})]}),(0,r.jsxs)(m.Z,{error:!!l.place,children:[(0,r.jsxs)(f.Z,{sx:{width:"100%"},children:["place",r.jsx("pre",{className:"ml-auto text-xs subtle-hover",children:(0,i.r7)(s.selfie)})]}),r.jsx(R,{onUpdateCoords:N}),l?.place&&r.jsx(p.Z,{children:l.place})]})]})]}),r.jsx(v.gG,{className:"relative overflow-hidden h-[40rem] w-full",markers:y,style:"streets",changeStyleOnDragTo:"streets"}),r.jsx(D,{value:s.selfie.description,onChange:e=>c({description:e}),error:l.description}),r.jsx(g.Z,{startDecorator:r.jsx(d.Z,{className:"size-6"}),type:"submit",variant:"soft",children:"publish"}),r.jsx(g.Z,{startDecorator:r.jsx(u.Z,{className:"size-4"}),onClick:()=>{(0,i.G0)(t,{name:s.selfie.title,hash:s.selfie.hash},e=>b.push("/new"))},variant:"soft",color:"danger",size:"sm",children:"delete"})]}):r.jsx(h.ZP,{level:"h4",sx:{marginX:"auto",paddingY:10,color:"#ccc"},className:"text-inset-shadow",children:"Add images first"})};var U=s(5243),L=s(39158),I=s(79393);let Q=({className:e="",imageStyle:t={},onUploadStatusChange:s,src:a,type:c})=>{let{api:d}=(0,o.Rv)(),{data:u,hash:h,setData:m,hasLocation:f}=(0,o.dV)(),[x,p]=(0,n.useState)(null),[j,y]=(0,n.useState)((0,i.ZE)()),[w,b]=(0,n.useState)(!1),A=(0,n.useMemo)(()=>x||(a?"https://travel-api.kupfer.es"+a+`?t=${j}`:void 0),[x,a,j]),P=(0,n.useCallback)(e=>{let t=e[0];if(!t?.type.startsWith("image/")){l.toast.error("Invalid image type!");return}b(!0),E(t,e=>{p(e),s(!0);let r=new FormData;r.append("_file_",t),r.append("hash",h),r.append("type",c);let a=d({method:"POST",body:r,url:"/api/selfieupload",contentType:!1}).then(i.xO).then(e=>(p(null),y((0,i.ZE)()),e.gps&&!f?m(t=>({...t,images:{...t.images,[c]:e},selfie:N(t.selfie,e.gps)})):m(t=>({...t,images:{...t.images,[c]:e}})),e)).finally(()=>{s(!1),b(!1)});l.toast.promise(a,{success:e=>e.message,error:e=>e.message})})},[s,f]),_=()=>{let e=d({url:"/api/rotate-image",body:{hash:h,type:c}}).then(i.xO).then(e=>{y(+new Date)});l.toast.promise(e,{success:void 0,error:e=>String(e)})},C=e=>{m({...u,selfie:N(u.selfie,e,!0)})};return(0,r.jsxs)(r.Fragment,{children:[r.jsx(S,{onFileAdded:P,isUploading:w,className:e,children:A?r.jsx("div",{style:{backgroundImage:`url(${A})`,...t},"aria-description":"me"===c?"My image":"Landscape image"}):(0,r.jsxs)("div",{className:"text-inset-shadow text-lg",children:["Drop an image of ","me"===c?"yourself":"what you see"]})}),a&&r.jsx(I.ZP,{onClick:()=>_(),size:"sm",variant:"soft",color:"neutral",sx:{position:"absolute",right:10,bottom:10},title:"rotate clockwise",className:"group",children:r.jsx(U.Z,{className:"size-6 group-hover:animate-spin"})}),a&&u.images[c].gps&&r.jsx(v.bo,{title:r.jsx(r.Fragment,{children:"Set coordinates?"}),content:(0,r.jsxs)("div",{className:"flex flex-col",children:[r.jsx("span",{children:"This will set your image coordinates for this selfie."}),r.jsx("kbd",{children:(0,i.r7)(u.images[c].gps)}),r.jsx("span",{children:"The name of the location will also be changed."})]}),primaryButton:e=>r.jsx(g.Z,{onClick:()=>{C(u.images[c].gps),e()},startDecorator:r.jsx(O.Z,{className:"size-4"}),children:"set coordinates"}),secondaryButton:e=>r.jsx(g.Z,{startDecorator:r.jsx(L.Z,{className:"size-5"}),onClick:e,color:"neutral",sx:{marginRight:"auto"},children:"cancel"}),children:e=>r.jsx(I.ZP,{onClick:()=>e(),size:"sm",variant:"soft",color:"neutral",title:"use the coordinates of this image",className:"group",sx:{position:"absolute",left:10,bottom:10},children:r.jsx(O.Z,{className:"size-6 group-hover:animate-bounce"})})})]})},H=()=>{let{data:e}=(0,o.dV)(),t=(e,t)=>{},s=t=>{let s=e.images[t].color?.color??"";return e.images[t].img&&s?{boxShadow:e.images[t].img?(0,i.t6)(s):void 0,border:`10px solid rgb(${s})`,backgroundColor:`rgb(${s})`,width:"100%",aspectRatio:"4 / 3",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"}:{}};return(0,r.jsxs)("div",{className:"grid grid-flow-col grid-rows-2 lg:grid-rows-1 lg:grid-flow-row lg:grid-cols-2 gap-10",children:[r.jsx("div",{className:"relative",children:r.jsx(Q,{src:e.images.me.img,type:"me",onUploadStatusChange:e=>t("me",e),className:"relative",imageStyle:s("me")})}),r.jsx("div",{className:"relative",children:r.jsx(Q,{src:e.images.lc.img,type:"lc",onUploadStatusChange:e=>t("lc",e),className:"relative",imageStyle:s("lc")})})]})};s(15424);var J=(0,s(46242).$)("e0452359b773ffa19b2ee032affea0c6869bfe57");let W=()=>{let{api:e}=(0,o.Rv)(),{data:t}=(0,o.dV)(),s=(0,a.useRouter)(),d=(0,n.useRef)(),u=(0,n.useRef)(JSON.stringify(t.selfie));return(0,n.useEffect)(()=>{t.selfie.visible||JSON.stringify(t.selfie)===u.current||(clearTimeout(d.current),d.current=setTimeout(()=>{let s=e({url:"/api/selfie/save-changes",body:t.selfie}).then(i.xO);l.toast.promise(s,{success:()=>(u.current=JSON.stringify(t.selfie),"(saved in the background)"),error:e=>String(e)})},5e3));let s=d.current;return()=>clearTimeout(s)},[t.selfie]),(0,r.jsxs)("div",{className:"flex flex-col space-y-8 w-[95vw] sm:w-[90vw] mx-auto lg:w-[60vw]",children:[r.jsx(H,{}),r.jsx($,{onSubmit:()=>{if(!c.iW.safeParse(t.selfie).success){l.toast.error("please correct the errors!");return}l.toast.promise(J(t.selfie),{success:e=>(s.push(e.redirect),e.message),error:e=>String(e)})}})]})}},45086:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AlertDialogModal:()=>u});var r=s(10326),a=s(87990),n=s(77904),l=s(31421),o=s(77716),i=s(24654),c=s(75632),d=s(17577);let u=({children:e,title:t,content:s,primaryButton:u,secondaryButton:h})=>{let[m,f]=(0,d.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[e(()=>f(!0)),r.jsx(a.ZP,{open:m,onClose:()=>f(!1),children:(0,r.jsxs)(n.Z,{variant:"outlined",role:"alertdialog",children:[t&&r.jsx(l.Z,{children:t}),r.jsx(o.Z,{}),r.jsx(i.Z,{children:s}),(0,r.jsxs)(c.Z,{children:[u(()=>f(!1)),h?.(()=>f(!1))]})]})})]})}},89217:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CopyPath:()=>n});var r=s(10326),a=s(14295);let n=e=>r.jsx(a.CopyToClipboard,{...e,copyValue:window?.location.href??"",showNotification:"URL copied! Share it anywhere"})},14295:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CopyToClipboard:()=>i});var r=s(10326),a=s(99446),n=s(68544),l=s(17577),o=s(11220);let i=({showNotification:e=null,withIcon:t=!0,...s})=>{let[i,c]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(i){let e=(0,o.gw)(()=>c(!1),1e3);return()=>clearTimeout(e)}},[i]),(0,r.jsxs)("a",{href:"#",className:"flex items-center space-x-2 "+(s.className??""),role:"button","aria-label":"copy to clipboard",style:{cursor:"pointer",textDecoration:"none"},onClick:t=>{t.preventDefault(),t.stopPropagation(),(0,o.vQ)(s.copyValue,()=>{s.onCopy?.(),c(!0)},e)},children:[t&&(i?r.jsx(a.Z,{className:"size-4 text-green-500"}):s.icon??r.jsx(n.Z,{className:"size-4 hover:text-blue-500"})),s.text&&r.jsx("span",{children:s.text})]})}},52116:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SystemModeColorCookie:()=>o});var r=s(10326),a=s(8206),n=s(66562),l=s(17577);let o=()=>{let{systemMode:e}=(0,a.tv)();return(0,l.useEffect)(()=>{n.Z.set("theme",e??"system"),document.documentElement.className=e??"_system_"},[e]),r.jsx(r.Fragment,{})}},10613:(e,t,s)=>{"use strict";s.r(t),s.d(t,{HistoryMap:()=>p});var r=s(10326),a=s(59732),n=s(6874),l=s(48029),o=s.n(l),i=s(17577),c=s(40480),d=s(10474),u=s(11220);let h=(e,t,s)=>{let r=[];for(let a=0,n=e.length;a<n;++a){let n=+new Date(e[a].selfie_date);n<=t[1]+d.Mb&&n>=t[0]-d.Mb&&r.push((0,u.Ww)(e[a],{url:s,lc:!1}))}return r},m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=e=>e>=2&&e<=4?"Spring":e>=5&&e<=7?"Summer":e>=8&&e<=10?"Fall":"Winter",x=e=>{let t=new Date(e[0]),s=new Date(e[1]),r=t.getMonth(),a=t.getFullYear(),n=s.getMonth(),l=s.getFullYear(),o=(e[1]-e[0])/31536e6,i=[];if(o>=9)for(let e=a;e<=l;e+=2){let t=new Date(e,0,1);i.push({value:t.getTime(),label:String(e)})}else if(o>4)for(let e=a;e<=l;e++){let t=new Date(e,0,1);i.push({value:t.getTime(),label:String(e)})}else if(o>1.3)for(let e=a;e<=l;e++)for(let t=0;t<4;t++){let s=3*t;if(e===a&&s<r)continue;if(e===l&&s>n)break;let o=new Date(e,s,1);i.push({value:o.getTime(),label:`${f(s)} ${e}`})}else for(let e=a;e<=l;e++){let t=e===a?r:0,s=e===l?n:11;for(let r=t;r<=s;r++){let t=new Date(e,r,1);i.push({value:t.getTime(),label:`${m[r]} ${e}`})}}return i},p=({className:e="",range:t,selfies:s,pinUrl:l})=>{let[m,f]=(0,i.useState)([Math.max(t[0],t[1]-d._4),t[1]]),[p,g]=(0,i.useState)(m),[v,j]=(0,i.useState)(!1),y=(0,i.useMemo)(()=>h(s,m,l),[m,l]),w=(0,i.useMemo)(()=>x(t),[]);return(0,r.jsxs)("div",{className:"w-full",children:[r.jsx(a.Z,{sx:{height:100,width:"100%"},children:r.jsx(n.Z,{min:t[0],max:t[1],step:d.xj,value:p,onChange:(e,t)=>{j(!0),g(t)},onChangeCommitted:(e,t)=>{f(t),j(!1)},valueLabelDisplay:"auto",valueLabelFormat:e=>new Date(e).toDateString(),marks:w,sx:{width:"90%",marginX:"auto","--Slider-thumbSize":"24px",".MuiSlider-track":{background:`linear-gradient(to right, ${d.ZG}, ${d.TW}) !important`},".MuiSlider-thumb":{"&::before":{borderColor:d.ZG+" !important",background:d.ZG},"&:last-of-type::before":{borderColor:d.TW+" !important",background:d.TW}}}})}),r.jsx(c.gG,{className:o()("relative overflow-hidden",e,(0,u.Ij)({loading:v,spinner:!0})),markers:y,style:"satellite",changeStyleOnDragTo:"satellite",connected:!0,lineColors:[d.ZG,d.TW],zoom:2})]})}},40480:(e,t,s)=>{"use strict";s.d(t,{bo:()=>r.AlertDialogModal,mu:()=>c.CopyPath,J7:()=>d.HistoryMap,gG:()=>u.MapViewer,M5:()=>h.SearchEverywhere,uN:()=>i});var r=s(45086),a=s(10326),n=s(60638),l=s(48029),o=s.n(l);let i=({className:e="",onClick:t,children:s,selected:r})=>a.jsx(n.Z,{onClick:t,className:o()("cursor-pointer hover:drop-shadow opacity-60 border-transparent",{"!border-gray-500 !opacity-100":r},e),children:s});s(14295);var c=s(89217);s(46226),s(34654),s(83450),s(41892),s(52116);var d=s(10613),u=s(68132),h=s(47132)},68132:(e,t,s)=>{"use strict";s.r(t),s.d(t,{MapViewer:()=>m});var r=s(10326);s(6793),s(11069);var a=s(48029),n=s.n(a),l=s(80810),o=s.n(l),i=s(17577),c=s(10474),d=s(11220);let u=(e,t)=>({id:(0,d.kb)(),type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e}},lineMetrics:!0},layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ccc","line-width":2,"line-gradient":["interpolate",["linear"],["line-progress"],0,t[0],1,t[1]]}}),h=e=>"satellite"===e?"mapbox://styles/mapbox/satellite-v9":"mapbox://styles/mapbox/streets-v12",m=({connected:e=!1,changeStyleOnDragTo:t="streets",className:s="",markers:a,style:l,lineColors:d=["#ccc","#ccc"],extraConfig:m,onExtraConfigLoaded:f,zoom:x=c.o0})=>{let p=(0,i.useRef)(),g=(0,i.useRef)(null),v=(0,i.useRef)([]),j=(0,i.useRef)(null),y=(0,i.useRef)(!1),w=(0,i.useRef)(!0),b=(0,i.useRef)(),A=(0,i.useCallback)(()=>{if(!y.current||!g.current){console.info("`handleSetMarkers` called before map was initialized");return}for(let e=0,t=v.current.length;e<t;++e)v.current[e].remove();j.current&&g.current.getLayer(j.current.id)&&g.current.removeLayer(j.current.id);let t=[];for(let e=0,s=a.length;e<s;++e){let s={lat:a[e].lat,lng:a[e].lng},r=document.createElement("div");r.innerHTML=a[e].icon;let n=new(o()).Marker(r).setLngLat(s).addTo(g.current);v.current.push(n),t.push([s.lng,s.lat])}a.length>1&&e&&(j.current=u(t,d),g.current.addLayer(j.current)),w.current&&m?.(g.current,v.current,j.current),setTimeout(()=>{if(!g.current)throw Error("Map seems to not have been loaded!");let e=t.reduce(function(e,t){return e.extend(t)},new(o()).LngLatBounds(t[0],t[0]));g.current.fitBounds(e,{padding:20}),w.current&&(g.current.resize(),g.current.triggerRepaint())},500)},[a]);return(0,i.useEffect)(()=>{w.current||g.current?.zoomTo(x)},[x]),(0,i.useEffect)(()=>{w.current||A()},[a]),(0,i.useLayoutEffect)(()=>{if(g.current)return;let e=a[0]??c.Tm;g.current=new(o()).Map({container:p.current,style:h(l),center:e,zoom:x,maxZoom:c.o_,accessToken:"pk.eyJ1Ijoibmljb2pvbmVzIiwiYSI6ImNqYjhvejQxNjA1eXkzMm9mcTljanBubGcifQ.WM7Ry1e1-1liibdD7PSNsA",boxZoom:!0,projection:{name:"globe",center:[e.lng,e.lat]},cooperativeGestures:!0,doubleClickZoom:!0,attributionControl:!1,renderWorldCopies:!1});let s=g.current;g.current.on("load",e=>{y.current=!0;let t=new(o()).NavigationControl({showCompass:!1});s.addControl(t,"top-left"),A(),w.current&&f?.(g.current,v.current,j.current),w.current=!1}),t!==l&&(g.current.on("drag",e=>{g.current?.setStyle(h(t))}),g.current.on("dragend",t=>{clearTimeout(b.current),b.current=setTimeout(()=>{g.current?.setStyle(h(l)),g.current?.panTo(e)},5e3)}))},[]),r.jsx("div",{className:n()("flex items-center justify-center relative w-full",s),"data-loading":"Refreshing...",children:r.jsx("div",{ref:p,className:s})})}},47132:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SearchEverywhere:()=>c});var r=s(10326),a=s(24719),n=s(35047),l=s(17577),o=s(85999),i=s(83164);let c=()=>{let[e,t]=(0,l.useState)(""),s=(0,n.useRouter)();return r.jsx(r.Fragment,{children:r.jsx("form",{onSubmit:t=>{t.preventDefault(),t.stopPropagation(),(0,i.B)("all",e,!0).then(t=>{if("redirect"in t){let e=t.searchType&&"selfie"!==t.searchType?`?type=${t.searchType}`:"";s.push(t.redirect+e)}else o.toast.error((0,r.jsxs)(r.Fragment,{children:["No results for ",r.jsx("kbd",{children:e})]}))})},children:r.jsx(a.ZP,{placeholder:"search everywhere",value:e,onChange:e=>{t(e.target.value)},type:"text",sx:{width:"100%"}})})})}},54297:(e,t,s)=>{"use strict";s.d(t,{U:()=>l});var r=s(10326);s(85654);var a=s(48029),n=s.n(a);let l=({open:e,onClick:t})=>(0,r.jsxs)("a",{role:"button",id:"main-menu-button",className:n()("menu-button menu-button-lines",{open:e}),onClick:()=>t(),children:[r.jsx("hr",{}),r.jsx("hr",{}),r.jsx("hr",{})]})},35209:(e,t,s)=>{"use strict";s.r(t),s.d(t,{HeaderAndDrawer:()=>G});var r=s(10326),a=s(76234),n=s(54673),l=s(26973),o=s(80975),i=s(31991),c=s(38737),d=s(31421),u=s(48962),h=s(24654),m=s(87908),f=s(72489),x=s(99883),p=s(51933),g=s(46226),v=s(90434),j=s(35047),y=s(17577),w=s(34654),b=s(40480),A=s(10474),S=s(16106),N=s(87154),E=s(81225),P=s(45204),_=s(32296),C=s(82777),D=s(13263),k=s(11836),O=s(4764),z=s(77716),Z=s(85836),T=s(79393),M=s(67160),F=s(62424),R=s(48029),$=s.n(R),U=s(11220);let L=({notification:e})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"text-secondary",children:[r.jsx(v.default,{href:`/u/${e.username}`,className:"font-bold cursor-pointer hover:underline",onClick:e=>e.stopPropagation(),children:e.name}),"\xa0 commented on your post \xa0",r.jsx(v.default,{href:`/s/${e.active_hash}`,className:"font-bold cursor-pointer hover:underline",children:e.title})]}),r.jsx("p",{children:e.comment})]}),I=({notification:e})=>r.jsx(r.Fragment,{children:(0,r.jsxs)("span",{className:"text-sm",children:[r.jsx(v.default,{href:`/u/${e.username}`,className:"font-bold cursor-pointer hover:underline",onClick:e=>e.stopPropagation(),children:e.name}),"\xa0 liked your post \xa0",r.jsx(v.default,{href:`/s/${e.active_hash}`,className:"font-bold cursor-pointer hover:underline",children:e.title})]})}),Q=({notification:e})=>(0,r.jsxs)("div",{className:"fric space-x-2",children:[r.jsx(g.default,{width:100,height:150,src:(0,U.Jm)({hash:e.hash}),alt:e.title}),(0,r.jsxs)("div",{className:"flex flex-col justify-around",children:[(0,r.jsxs)("span",{className:"text-sm",children:[r.jsx(v.default,{href:`/u/${e.username}`,className:"font-bold cursor-pointer hover:underline",onClick:e=>e.stopPropagation(),children:e.name}),"\xa0 has uploaded a new post"]}),r.jsx(v.default,{href:`/s/${e.active_hash}`,className:"font-bold cursor-pointer hover:underline",children:e.title})]})]}),H=({notification:e})=>{let{markAsRead:t,markAsUnead:s}=(0,S.lR)(),[a,n]=(0,y.useState)(!!e.seen);return(0,r.jsxs)("div",{className:$()("grid grid-cols-12 cursor-pointer hover:bg-slate-200 w-full py-1 relative",{"opacity-50 hover:opacity-100 transition-opacity":a}),role:"button",onClick:()=>{a?s(e.id):t(e.id),n(e=>!e)},children:[(0,r.jsxs)("div",{className:"fric col-span-2",children:[(0,r.jsxs)("div",{className:"h-full w-8 grid place-items-center",children:[r.jsx("span",{title:e.added_on,className:"absolute top-1 right-1 cursor-help text-xs",children:(0,U.Sy)(e.added_on)}),r.jsx("div",{className:$()("rounded-full w-3 aspect-square border border-blue-600",{"bg-blue-600":!a})})]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[r.jsx(k.Z,{src:"https://travel-api.kupfer.es"+e.avatar}),(0,r.jsxs)(v.default,{href:`/u/${e.username}`,target:"_blank",rel:"noreferrer",className:"text-secondary font-bold",onClick:e=>e.stopPropagation(),children:["@",e.username]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2 pl-6 col-span-10 justify-center",children:["comment"===e.notif_type&&r.jsx(L,{notification:e}),"like"===e.notif_type&&r.jsx(I,{notification:e}),"post"===e.notif_type&&r.jsx(Q,{notification:e})]})]})},J=({children:e})=>{let{notifications:t,loadMore:s}=(0,S.lR)(),a=(0,j.usePathname)(),[n,l]=(0,y.useState)(!1);return(0,y.useEffect)(()=>{l(!1)},[a]),(0,r.jsxs)(r.Fragment,{children:[r.jsx(c.Z,{anchor:"right",size:"lg",open:n,onClose:()=>l(!1),slotProps:{content:{}},children:(0,r.jsxs)(M.Z,{sx:{borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,height:"100%",overflow:"auto"},children:[r.jsx(d.Z,{level:"h2",children:"Notifications"}),r.jsx(u.Z,{size:"lg",sx:{marginRight:"auto"}}),(0,r.jsxs)(h.Z,{children:[r.jsx("div",{className:"flex flex-col space-y-4",children:t.map(e=>r.jsx(H,{notification:e},e.id))}),t.length>0&&r.jsx(F.Z,{variant:"plain",size:"sm",color:"neutral",onClick:s,className:"mt-4",children:"load older notifications"})]})]})}),e(()=>{l(e=>!e)})]})},W=()=>{let e=(0,j.usePathname)(),{isAuthed:t,user:s}=(0,S.Rv)(),{unread:a}=(0,S.lR)(),[n,l]=(0,y.useState)(!1),o=()=>{l(e=>!e)};(0,y.useEffect)(()=>{l(!1)},[e]);let i=(0,y.useMemo)(()=>s?r.jsx(k.Z,{size:"lg",src:"https://travel-api.kupfer.es"+s.avatar,onClick:o,className:"ml-auto cursor-pointer"}):null,[s]);return t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.Z,{anchor:"right",open:n,onClose:o,size:"sm",slotProps:{content:{sx:{minWidth:"max-content"}}},children:[(0,r.jsxs)(d.Z,{className:"fric justify-between",sx:{paddingLeft:2},children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[r.jsx(O.ZP,{level:"h3",children:s.name}),(0,r.jsxs)(v.default,{href:`/u/${s.username}`,children:["@",s.username]})]}),i]}),(0,r.jsxs)(h.Z,{sx:{paddingLeft:2},children:[r.jsx(z.Z,{}),(0,r.jsxs)(m.Z,{children:["menu"===s.bell_position&&r.jsx(r.Fragment,{children:r.jsx(J,{children:e=>r.jsx(f.Z,{children:(0,r.jsxs)(p.Z,{className:"fric",onClick:e,children:[r.jsx(x.Z,{children:r.jsx(Z.Z,{badgeContent:a,children:r.jsx(N.Z,{className:"size-5"})})}),r.jsx("span",{children:"notifications"})]})})})}),r.jsx(v.default,{href:"/dashboard",children:r.jsx(f.Z,{children:(0,r.jsxs)(p.Z,{className:"fric",children:[r.jsx(x.Z,{children:r.jsx(E.Z,{className:"size-5"})}),r.jsx("span",{children:"dashboard"})]})})}),r.jsx(v.default,{href:"/new",children:r.jsx(f.Z,{children:(0,r.jsxs)(p.Z,{className:"fric",children:[r.jsx(x.Z,{children:r.jsx(P.Z,{className:"size-5"})}),r.jsx("span",{children:"upload"})]})})}),r.jsx(v.default,{href:"/dashboard/settings",children:r.jsx(f.Z,{children:(0,r.jsxs)(p.Z,{className:"fric",children:[r.jsx(x.Z,{children:r.jsx(_.Z,{className:"size-5"})}),r.jsx("span",{children:"settings"})]})})}),r.jsx(v.default,{href:"/auth/logout",className:"mt-auto",children:r.jsx(f.Z,{children:(0,r.jsxs)(p.Z,{className:"fric",children:[r.jsx(x.Z,{children:r.jsx(C.Z,{className:"size-5"})}),r.jsx("span",{children:"log out"})]})})})]})]})]}),(0,r.jsxs)("div",{className:"mt-2 mr-1 fric space-x-4",children:["top"===s.bell_position&&r.jsx(J,{children:e=>r.jsx(Z.Z,{badgeContent:a,children:r.jsx(T.ZP,{variant:"plain",onClick:e,className:"text-black dark:text-white rounded-full hover:rounded-full",size:"lg",children:r.jsx(N.Z,{className:"size-6"})})})}),i]})]}):r.jsx(r.Fragment,{children:r.jsx(v.default,{href:"/auth/sign-in",className:"p-4 group",children:r.jsx(D.Z,{className:"size-14 opacity-20 group-hover:opacity-60 transition-opacity"})})})};var B=s(54297);let G=()=>{let e=(0,j.usePathname)(),{isAuthed:t}=(0,S.Rv)(),[s,N]=(0,y.useState)(!1),E=()=>{N(e=>!e)};return(0,y.useEffect)(()=>{N(!1)},[e]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.Z,{size:"sm",anchor:"left",open:s,onClose:E,slotProps:{content:{sx:{minWidth:"max-content"}}},children:[r.jsx(d.Z,{level:"h2",sx:{paddingX:2},children:"Menu"}),r.jsx(u.Z,{size:"lg"}),r.jsx(h.Z,{children:(0,r.jsxs)(m.Z,{sx:{paddingX:2,minWidth:"max-content"},children:[r.jsx(f.Z,{children:(0,r.jsxs)("div",{className:"fric space-x-4",children:[r.jsx(x.Z,{children:r.jsx(a.Z,{className:"size-6"})}),r.jsx(b.M5,{})]})}),r.jsx(f.Z,{children:r.jsx(v.default,{href:"/",className:"w-full",children:(0,r.jsxs)(p.Z,{className:"fric space-x-2",children:[r.jsx(x.Z,{children:r.jsx(n.Z,{className:"size-6"})}),r.jsx("span",{children:"All selfies"})]})})}),t&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(f.Z,{children:r.jsx(v.default,{href:"/discover",className:"w-full",children:(0,r.jsxs)(p.Z,{className:"fric space-x-2",children:[r.jsx(x.Z,{children:r.jsx(l.Z,{className:"size-6"})}),r.jsx("span",{children:"Discover"})]})})}),r.jsx(f.Z,{children:r.jsx(v.default,{href:"/loves",className:"w-full",children:(0,r.jsxs)(p.Z,{className:"fric space-x-2",children:[r.jsx(x.Z,{children:r.jsx(o.Z,{className:"size-6"})}),r.jsx("span",{children:"Loved by you"})]})})})]}),r.jsx(f.Z,{children:r.jsx(v.default,{href:"/users",className:"w-full",children:(0,r.jsxs)(p.Z,{className:"fric space-x-2",children:[r.jsx(x.Z,{children:r.jsx(i.Z,{className:"size-6"})}),r.jsx("span",{children:"Users"})]})})})]})})]}),(0,r.jsxs)("nav",{className:"fric justify-between pl-3 lg:pl-12 pr-2 py-2 fixed top-0 left-0 w-screen h-[var(--header-height)] z-[1]",children:[(0,r.jsxs)("div",{className:"fric space-x-3 lg:space-x-8",children:[r.jsx(B.U,{open:s,onClick:E}),r.jsx(v.default,{href:t?A.Mg:A.P9,children:r.jsx(g.default,{src:w.s,width:50,height:50,alt:"Logo",priority:!0})})]}),r.jsx("div",{className:"fric space-x-4 -z-[1]",children:r.jsx(S.qF,{children:r.jsx(W,{})})})]})]})}},83450:(e,t,s)=>{"use strict";s(35209),s(54297),s(10326),s(48029)},14230:(e,t,s)=>{"use strict";s.d(t,{$O:()=>r.$O,He:()=>r.He,n4:()=>r.n4,F0:()=>r.F0,Lh:()=>r.Lh,WV:()=>r.WV,Y2:()=>r.Y2,Dj:()=>r.Dj});var r=s(41892);s(83450),s(71131),s(10326),s(90434),s(48221)},68813:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SelfiesAsyncLoader:()=>c});var r=s(10326),a=s(17577),n=s(85999),l=s(10474),o=s(70712),i=s(79951);let c=({children:e,skip:t,fetcher:s})=>{let[c,d]=(0,a.useState)({selfies:[],skip:t,loading:!1,more:!!s}),u=(0,a.useCallback)(()=>{if(c.loading||!c.more||!s)return;let e=window.document.documentElement,t=e.scrollHeight-e.clientHeight-l._r;window.scrollY>t&&(console.log("GETTING MORE ELEMENTS",c.skip),d(e=>({...e,loading:!0})),s(c.skip).then(e=>d(t=>({...t,more:!!e.more,skip:c.skip+e.selfies.length,selfies:[...t.selfies,...e.selfies],loading:!1}))).catch(e=>{d(e=>({...e,loading:!1})),n.toast.error(String(e))}))},[c.loading,c.skip,c.more,s]);return(0,a.useEffect)(()=>{let e;let t=()=>{clearTimeout(e),e=setTimeout(u,300)};return window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t),clearTimeout(e)}},[u]),(0,r.jsxs)("main",{className:"flex flex-col space-y-48",onScroll:u,children:[e,c.selfies.map(e=>r.jsx(o.F,{selfie:e},e.id)),r.jsx(i.ThatsAllFolks,{hidden:c.more})]})}},70712:(e,t,s)=>{"use strict";s.d(t,{F:()=>h});var r=s(10326),a=s(48029),n=s.n(a),l=s(46226),o=s(10474),i=s(11220),c=s(94597),d=s(3952),u=s(59805);let h=({className:e="",disabled:t=!1,priority:s=!1,selfie:a})=>(0,r.jsxs)("div",{className:n()("flex flex-col max-w-full",e,{"pointer-events-none select-none":t}),style:{background:(0,i.OH)(a.me_color,a.lc_color),boxShadow:(0,i.t6)(a.me_color)},children:[r.jsx(u.SelfieHeader,{selfie:a}),(0,r.jsxs)("div",{role:"content",className:"flex flex-col md:flex-row relative",children:[!t&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(d.LoveSelfie,{selfie:a}),r.jsx(c.H,{selfie:a})]}),r.jsx(l.default,{src:t?o.Ty:(0,i.iQ)(a),alt:"My image",className:"w-full md:w-1/2",width:1e3,height:750,priority:s}),r.jsx(l.default,{src:t?o.Ty:(0,i.Jj)(a),alt:"Landscape image",className:"w-full md:w-1/2",width:1e3,height:750,priority:s})]})]})},26733:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SelfieCardLoader:()=>i});var r=s(10326),a=s(17577),n=s(16106),l=s(70712),o=s(79601);let i=({hash:e})=>{let{api:t}=(0,n.Rv)(),[s,i]=(0,a.useState)(null);return(0,a.useEffect)(()=>{t({body:{s:"one",hash:e}}).then(e=>{i(e.responseData.selfie)})},[]),s?r.jsx(l.F,{selfie:s,priority:!1,className:"!max-w-[1000px] w-full my-24 mx-auto"}):r.jsx(o.W,{className:"!max-w-[1000px] w-full my-24 mx-auto"})}},79601:(e,t,s)=>{"use strict";s.d(t,{W:()=>i});var r=s(10326),a=s(80560),n=s(23908),l=s(48029),o=s.n(l);let i=({className:e=""})=>(0,r.jsxs)("div",{className:o()("flex flex-col max-w-full border border-solid",e),children:[(0,r.jsxs)("div",{role:"header",className:"flex flex-col md:flex-row md:space-y-0 sm:space-x-0 md:space-x-4 md:fric space-y-2 justify-between p-4",children:[(0,r.jsxs)("div",{className:"flex flex-col md:grow",children:[r.jsx(a.Z,{animation:"wave",variant:"text",level:"h1",sx:{width:"100%"}}),r.jsx(a.Z,{animation:"wave",variant:"text",level:"h2",sx:{width:"100%"}})]}),(0,r.jsxs)("div",{className:"flex flex-col w-72",children:[r.jsx(a.Z,{animation:"wave",variant:"text",sx:{width:"100%"}}),r.jsx(a.Z,{animation:"wave",variant:"text",sx:{width:"100%"}}),r.jsx(a.Z,{animation:"wave",variant:"text",sx:{width:"100%"}})]})]}),(0,r.jsxs)("div",{role:"content",className:"flex flex-col md:flex-row relative md:justify-between",children:[r.jsx(n.Z,{ratio:"4/3",sx:{width:"49%"},children:r.jsx(a.Z,{animation:"wave",sx:{width:"100%"}})}),r.jsx(n.Z,{ratio:"4/3",sx:{width:"49%"},children:r.jsx(a.Z,{animation:"wave",sx:{width:"100%"}})})]})]})},88313:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SelfieDate:()=>l});var r=s(10326),a=s(17577),n=s(11220);let l=({date:e,icon:t,isDate:s=!1,label:l})=>{let[o,i]=(0,a.useState)(!1),c=(0,a.useMemo)(()=>(0,n.p6)((0,n.ZP)(e),s),[e]);return(0,r.jsxs)("span",{className:"fric space-x-3 cursor-pointer",role:"button",onClick:()=>i(e=>!e),children:[t,o?r.jsx("span",{title:(l?l+" ":"")+(0,n.Sy)(e,s),children:c}):r.jsx("span",{title:(l?l+" ":"")+c,children:(0,n.Sy)(e,s)})]})}},59805:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SelfieHeader:()=>u});var r=s(10326),a=s(45204),n=s(13191),l=s(4764),o=s(90434),i=s(11220),c=s(88313),d=s(66009);let u=({selfie:e})=>{let t=(0,i.SH)(e),s=(0,i.SH)(e,"lc");return r.jsx(d.SelfieMap,{selfie:e,children:(i,d)=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{role:"header",className:"flex flex-col md:flex-row md:space-y-0 sm:space-x-0 md:space-x-4 space-y-2 justify-between p-4",children:[(0,r.jsxs)(o.default,{href:`/s/${e.hash}`,className:"flex flex-col as-link",style:{color:t},children:[r.jsx(l.ZP,{level:"h1",sx:{color:t},children:e.title}),r.jsx(l.ZP,{level:"h3",sx:{color:t},children:e.short_desc})]}),(0,r.jsxs)("div",{className:`flex flex-col text-base text-[${s}] shrink-0`,children:[r.jsx(c.SelfieDate,{icon:r.jsx(a.Z,{className:"size-4"}),label:"taken",date:e.selfie_date,isDate:!0}),i,(0,r.jsxs)(o.default,{href:`/u/${e.username}`,className:"fric space-x-3 as-link",children:[r.jsx(n.Z,{className:"size-4"}),(0,r.jsxs)("span",{children:["@",e.username]})]})]})]}),d]})})}},66009:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SelfieMap:()=>i});var r=s(10326),a=s(56873),n=s(17577),l=s(40480),o=s(11220);let i=({children:e,selfie:t})=>{let[s,i]=(0,n.useState)(!1),c=(0,n.useMemo)(()=>(0,o.Ww)(t),[t]);return e((0,r.jsxs)("span",{className:"fric space-x-3 cursor-pointer",onClick:()=>{i(e=>!e)},title:s?"close map":"open map",children:[r.jsx(a.Z,{className:"size-4"}),r.jsx("span",{children:s?`(${t.lat.toFixed(2)}, ${t.lng.toFixed(2)})`:t.selfie_place})]}),s&&r.jsx(l.gG,{markers:[c],style:"satellite",className:"w-full h-96"}))}},79951:(e,t,s)=>{"use strict";s.r(t),s.d(t,{ThatsAllFolks:()=>o});var r=s(10326),a=s(46226),n=s(17577),l=s(34654);let o=({hidden:e})=>{let[t,s]=(0,n.useState)(!1);return e?r.jsx(a.default,{src:l.w,className:"w-7/12 inline-block invisible size-0",alt:"No more selfies to show"}):r.jsx("div",{role:"button",onClick:()=>{s(!0)},style:{backgroundImage:`url(${l.w.default.src})`},className:"bg-center bg-cover inline-block h-96 opacity-30",children:t&&r.jsx("iframe",{src:"https://www.youtube.com/embed/Q3bbsDJWlXQ?autoplay=1&controls=0&rel=0&modestbranding=1&autohide=1&mute=1",className:"w-full h-full"})})}},28003:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AddComment:()=>x});var r=s(10326),a=s(59732),n=s(24719),l=s(62424),o=s(90434),i=s(17577),c=s(85999),d=s(16106),u=s(11220),h=s(96346),m=s(89869);let f=(e,t,s)=>({comment:t,name:s.name,username:s.username,id:e,added_on:new Date().toISOString(),avatar:s.avatar}),x=({selfie:e})=>{let{api:t,isAuthed:s,user:x}=(0,d.Rv)(),[p,g]=(0,i.useState)(""),[v,j]=(0,i.useState)([]),y=(0,u.SH)(e),w=(0,i.useCallback)(s=>{if(s.preventDefault(),!p.length){(0,c.toast)("Please enter a longer comment");return}let r=Math.random();j(e=>[f(r,p,x),...e]),t({url:"/api/comments/post",body:{comment:p,selfie:e.hash}}).then(u.xO).then(e=>e.comment).then(e=>{j(t=>[...t.map(t=>t.id===r?e:t)]),g("")}).catch(()=>{j(e=>[...e.filter(e=>e.id!==r)])})},[t,p,e.hash,x]);return(0,r.jsxs)(r.Fragment,{children:[s?(0,r.jsxs)("form",{onSubmit:w,className:"flex flex-row justify-between comment-styles",children:[r.jsx(a.Z,{className:"grow",children:r.jsx(n.ZP,{placeholder:"Enter a comment...",value:p,onChange:e=>g(e.target.value),type:"text",sx:{backgroundColor:"transparent",borderColor:"transparent",boxShadow:"none",color:y,flexGrow:1,":focus":{outline:"none"},":focus-visible":{outline:"none"}},autoComplete:"off"})}),r.jsx(l.Z,{type:"submit",sx:{borderRadius:0,margin:"-.5rem",backgroundColor:"white",":hover":{backgroundColor:"white"}},children:r.jsx("span",{className:"text-gray-800",children:"add comment"})})]}):r.jsx(m.X,{color:y,children:r.jsx(o.default,{href:"/auth/sign-in",className:"underline hover:no-underline",children:"sign in to add a comment"})}),v.map(t=>r.jsx(h.H,{comment:t,selfie:e},t.id))]})}},96346:(e,t,s)=>{"use strict";s.d(t,{H:()=>o});var r=s(10326),a=s(11836),n=s(90434),l=s(11220);let o=({comment:e,selfie:t})=>{let s=(0,l.SH)(t);return(0,r.jsxs)("div",{className:`bg-transparent text-[${s}] fric space-x-2 comment-styles`,children:[(0,r.jsxs)("div",{className:"flex flex-col space-y-1",children:[r.jsx(a.Z,{src:`https://travel-api.kupfer.es${e.avatar}`,alt:`Avatar of ${e.name}`,className:"size-10"}),(0,r.jsxs)(n.default,{href:`/u/${e.username}`,className:"flex flex-col",children:[r.jsx("span",{children:e.name}),(0,r.jsxs)("small",{children:["@",e.username]})]})]}),(0,r.jsxs)("p",{className:"p-3 relative fric grow h-full",children:[e.comment,(0,r.jsxs)("small",{className:"absolute -bottom-1 -right-1",children:["on ",e.added_on]})]})]})}},13294:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CommentList:()=>d});var r=s(10326),a=s(17577),n=s(11220),l=s(28003),o=s(96346),i=s(89869);s(15424);var c=(0,s(46242).$)("b1a41dc2655d851f110a3d69243a3ac2141b1080");let d=({selfie:e})=>{let[t,s]=(0,a.useState)(null);return(0,a.useEffect)(()=>{c(e.hash).then(e=>s(e))},[e.hash]),(0,r.jsxs)("div",{className:"flex flex-col",children:[r.jsx(l.AddComment,{selfie:e}),t?t.length?t.map(t=>r.jsx(o.H,{comment:t,selfie:e},t.id)):r.jsx(i.X,{color:(0,n.SH)(e),hoverEffect:!1,children:"No comments yet. Be the first"}):"Loading..."]})}},89869:(e,t,s)=>{"use strict";s.d(t,{X:()=>l});var r=s(10326),a=s(48029),n=s.n(a);let l=({children:e,color:t,hoverEffect:s=!1})=>r.jsx("div",{className:"comment-styles fric justify-center grow",style:{color:t},children:r.jsx("label",{className:n()("opacity-25 p-10",{"hover:opacity-100":s}),children:e})})},10006:(e,t,s)=>{"use strict";s.r(t),s.d(t,{EditSelfieButton:()=>x});var r=s(10326),a=s(26487),n=s(57451),l=s(48029),o=s.n(l),i=s(90434),c=s(35047),d=s(17577),u=s(16106),h=s(11220);let m="cursor-pointer hover:drop-shadow-sm transition-all relative select-none",f="size-7 bg-white rounded-full z-10 p-1",x=({allowDelete:e,selfie:t})=>{let{api:s,isAuthed:l,user:x}=(0,u.Rv)(),p=x?.id===t.user_id,g=(0,c.useRouter)(),v=(0,d.useCallback)(()=>{(0,h.G0)(s,t,e=>g.push("/"))},[s,t]);return l&&p?(0,r.jsxs)("span",{className:"absolute left-[90%] lg:left-[50%] top-1/2 translate-y-[-50%] lg:translate-y-0 lg:top-8 translate-x-[-50%] flex lg:flex-col flex-row lg:space-y-2 lg:space-x-0 space-x-2",children:[r.jsx(i.default,{href:`/edit/${t.hash}`,className:m,children:r.jsx(a.Z,{className:f})}),e&&r.jsx("a",{role:"button",onClick:v,className:o()(m,"opacity-40 hover:opacity-100"),children:r.jsx(n.Z,{className:o()(f,"text-red-500")})})]}):r.jsx(r.Fragment,{})}},94597:(e,t,s)=>{"use strict";s.d(t,{H:()=>r.EditSelfieButton});var r=s(10006)},41892:(e,t,s)=>{"use strict";s.d(t,{$O:()=>d.CommentList,He:()=>i.H,n4:()=>c.LoveSelfie,F0:()=>r.F,Lh:()=>l.SelfieCardLoader,WV:()=>n.W,Y2:()=>o.SelfieDate,Dj:()=>a.SelfiesAsyncLoader});var r=s(70712);s(10326),s(83450);var a=s(68813);s(59805),s(79951);var n=s(79601),l=s(26733),o=s(88313);s(66009);var i=s(94597),c=s(3952);s(47112),s(38911),s(28003),s(96346);var d=s(13294);s(89869)},3952:(e,t,s)=>{"use strict";s.r(t),s.d(t,{LoveSelfie:()=>d});var r=s(10326),a=s(48029),n=s.n(a),l=s(17577),o=s(16106),i=s(80975);let c=({count:e})=>(0,r.jsxs)(r.Fragment,{children:[r.jsx(i.Z,{className:"absolute top-0 mx-auto size-10 text-red-500"}),r.jsx("span",{className:"relative z-10 top-2 w-full text-center text-white text-sm inline-block",children:e})]}),d=({selfie:e})=>{let{api:t,isAuthed:s}=(0,o.Rv)(),[a,i]=(0,l.useState)(e.loves),[d,u]=(0,l.useState)(1===e.love);return r.jsx("span",{className:"absolute left-[50%] top-1/2 translate-y-[-50%] lg:translate-y-0 lg:-top-3 translate-x-[-50%]",children:s?r.jsx("a",{role:"button",onClick:()=>{i(e=>d?e-1:e+1),u(e=>!e),t({url:"/api/love",body:{selfie:e.hash}}).then(e=>e.responseData).catch(e=>{console.error(e),i(e=>d?e+1:e-1),u(e=>!e)})},className:n()("cursor-pointer inline-block hover:drop-shadow-sm transition-all relative select-none w-10",!s||e.love?"opacity-100":"opacity-80 hover:opacity-100 hover:drop-shadow"),children:r.jsx(c,{count:a})}):r.jsx("span",{className:"relative inline-block w-10",children:r.jsx(c,{count:a})})})}},38911:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SelfiePrevNext:()=>o});var r=s(10326),a=s(46226),n=s(29466),l=s(11220);let o=()=>{let{prev:e,next:t,loadSelfie:s}=(0,n.T)();return(0,r.jsxs)(r.Fragment,{children:[e&&(0,r.jsxs)("a",{role:"button",className:"cursor-pointer opacity-30 hover:opacity-50 left-0 h-full absolute translate-x-[-100%] transition-opacity",onClick:()=>s(e.active_hash),children:[r.jsx(a.default,{src:(0,l.Jj)(e),alt:"Previous image: "+e.title,className:"h-full w-auto",width:1e3,height:750}),r.jsx(a.default,{src:(0,l.iQ)(e),alt:"Previous image: "+e.title,className:"-left-[1000rem] absolute",width:1e3,height:750})]}),t&&(0,r.jsxs)("a",{role:"button",className:"cursor-pointer opacity-30 hover:opacity-50 right-0 h-full absolute translate-x-[100%] transition-opacity",onClick:()=>s(t.active_hash),children:[r.jsx(a.default,{src:(0,l.iQ)(t),alt:"Next image: "+t.title,className:"h-full w-auto",width:1e3,height:750}),r.jsx(a.default,{src:(0,l.Jj)(t),alt:"Previous image: "+t.title,className:"-left-[1000rem] absolute",width:1e3,height:750})]})]})}},47112:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SingleSelfie:()=>y});var r=s(10326),a=s(13191),n=s(47029),l=s(45204),o=s(10058),i=s(56873),c=s(4764),d=s(46226),u=s(90434),h=s(14230);let m=/(?:https:\/\/travel\.kupfer\.es)?\/s\/([a-zA-Z0-9]+)/g,f=e=>{let t=[],s=0;return e.replace(m,(a,n,l)=>(t.push(r.jsx("span",{className:"quill-part",dangerouslySetInnerHTML:{__html:e.substring(s,l)}},s)),t.push(r.jsx(h.Lh,{hash:n},l)),s=l+a.length,a)),t.push(r.jsx("span",{dangerouslySetInnerHTML:{__html:e.substring(s)}},s)),t};var x=s(40480),p=s(10474),g=s(29466),v=s(11220),j=s(38911);let y=({exists:e=!0})=>{let{selfie:t}=(0,g.T)(),s=(0,v.SH)(t),m=(0,v.SH)(t,"lc"),y=(0,v.Ww)(t);return r.jsx("div",{className:"flex flex-col max-w-screen py-[var(--header-height)] relative fill-screen overflow-x-hidden",style:{background:(0,v.OH)(t.me_color,t.lc_color)},children:(0,r.jsxs)("div",{className:"flex flex-col mx-auto w-[calc(100vw-100px)] md:w-[calc(100vw-200px)] lg:w-[calc(100vw-300px)]",children:[(0,r.jsxs)("div",{role:"header",className:"flex md:flex-row md:items-center md:justify-between md:space-y-0 flex-col space-y-2 py-4",children:[(0,r.jsxs)("div",{className:"flex flex-col space-y-4",children:[r.jsx(c.ZP,{level:"h1",sx:{color:s},children:t.title}),r.jsx(c.ZP,{level:"h3",sx:{color:s},children:t.short_desc})]}),e&&(0,r.jsxs)("div",{className:`flex flex-col min-w-max text-base text-[${m}]`,children:[(0,r.jsxs)("span",{className:"flex justify-between",children:[(0,r.jsxs)(u.default,{href:`/u/${t.username}`,className:"fric space-x-2 as-link",children:[r.jsx(a.Z,{className:"size-4"}),r.jsx("small",{children:"by"}),(0,r.jsxs)("span",{children:["@",t.username]})]}),r.jsx(x.mu,{className:"bg-white p-1 text-black rounded-full",icon:r.jsx(n.Z,{className:"size-4 hover:text-blue-500"})})]}),r.jsx(h.Y2,{icon:r.jsx(l.Z,{className:"size-4"}),label:"taken",date:t.selfie_date,isDate:!0}),r.jsx(h.Y2,{icon:r.jsx(o.Z,{className:"size-4"}),label:"added",date:t.added_on}),(0,r.jsxs)("span",{className:"fric space-x-2",children:[r.jsx(i.Z,{className:"size-4"}),r.jsx("small",{children:"in"}),r.jsx("span",{children:t.selfie_place})]})]})]}),(0,r.jsxs)("div",{role:"content",className:"grid grid-flow-col lg:grid-flow-row grid-cols-1 grid-rows-2 lg:grid-rows-1 lg:grid-cols-2 relative",children:[e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(h.n4,{selfie:t}),r.jsx(h.He,{selfie:t,allowDelete:!0})]}),r.jsx(d.default,{src:e?(0,v.iQ)(t):p.Ty,alt:"My image for "+t.title,className:"w-full aspect-[4/3]",width:1e3,height:750,priority:!0}),r.jsx(d.default,{src:e?(0,v.Jj)(t):p.Ty,alt:"Landscape image for "+t.title,className:"w-full aspect-[4/3]",width:1e3,height:750,priority:!0}),e&&r.jsx(j.SelfiePrevNext,{})]}),e&&(0,r.jsxs)("div",{className:"grid grid-flow-col lg:grid-flow-row grid-rows-2 grid-cols-1 lg:grid-cols-2 lg:grid-rows-1",children:[r.jsx(x.gG,{markers:[y],style:"satellite",className:"min-h-96 max-h-[45rem] w-full block"}),r.jsx(h.$O,{selfie:t})]}),t.long_desc.length>=5&&r.jsx("div",{className:"w-full border mx-auto p-16 flex flex-col justify-center",style:{color:s},children:f(t.long_desc)})]})})}},46714:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Toaster:()=>l});var r=s(10326),a=s(14831),n=s(85999);let l=({...e})=>{let{theme:t="system"}=(0,a.F)();return r.jsx(n.Toaster,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})}},71131:(e,t,s)=>{"use strict";s.r(t),s.d(t,{UserPageHeader:()=>g});var r=s(10326),a=s(4764),n=s(62424),l=s(11836),o=s(17577),i=s(85999),c=s(16106),d=s(11220),u=s(39158),h=s(56873),m=s(48029),f=s.n(m),x=s(40480);let p=({username:e})=>{let{api:t}=(0,c.Rv)(),[s,a]=(0,o.useState)(!1),[l,m]=(0,o.useState)(void 0);return(0,o.useEffect)(()=>{s&&!l&&t({url:"/api/history",body:{username:e}}).then(d.xO).then(({mapSelfies:e,mapSelfiesRange:t})=>{m({mapSelfies:e,mapSelfiesRange:t})}).catch(e=>{i.toast.error(String(e)),console.error(e)})},[s]),r.jsx(r.Fragment,{children:s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.Z,{onClick:()=>a(!1),variant:"soft",size:"sm",color:"neutral",children:[r.jsx(u.Z,{className:"size-4"})," \xa0 close map"]}),l?.mapSelfiesRange?r.jsx(x.J7,{className:"relative h-[60rem] max-h-[80vh] w-full",range:l.mapSelfiesRange,selfies:l.mapSelfies,pinUrl:"view"}):r.jsx("span",{className:f()("relative h-[60rem] max-h-[80vh] w-full fric justify-center",(0,d.Ij)({loading:!0,spinner:!0})),"data-loading":"loading map..."})]}):(0,r.jsxs)(n.Z,{onClick:()=>a(!0),variant:"soft",size:"sm",color:"neutral",children:[r.jsx(h.Z,{className:"size-4"})," \xa0 see on a map"]})})},g=({user:e})=>{let{api:t,isAuthed:s,user:u}=(0,c.Rv)(),[h,m]=(0,o.useState)(s&&e.username!==u.username?!!e.ifollow:null),f=e.followers-Number(e.ifollow)+Number(h);return r.jsx(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex flex-col space-y-4 justify-center w-full",children:[(0,r.jsxs)("div",{className:"fric justify-center space-x-6",children:[(0,r.jsxs)(a.ZP,{level:"h1",children:["@",e.username]}),null!==h&&r.jsx(n.Z,{size:"sm",onClick:()=>{m(e=>!e),t({url:"/api/follow",body:{username:e.username}}).catch(e=>{m(e=>!e),i.toast.error(String(e))})},color:h?"neutral":"success",variant:"soft",sx:{p:.5},children:h?"following":"follow"})]}),(0,r.jsxs)("div",{className:"fric space-x-8 w-full",children:[r.jsx(l.Z,{src:e.avatar,alt:e.name,sx:{width:128,height:128},variant:"outlined"}),(0,r.jsxs)("div",{className:"flex flex-col space-y-4 shrink basis-full",children:[(0,r.jsxs)("div",{className:"fric justify-between",children:[r.jsx("span",{children:(0,d.gY)(e.pictures,["picture","pictures"])}),r.jsx("span",{children:(0,d.gY)(f,["follower","followers"])}),(0,r.jsxs)("span",{children:[e.following," following"]})]}),(0,r.jsxs)("p",{children:[r.jsx(a.ZP,{level:"body-lg",sx:{fontWeight:"bold"},children:e.name})," ",r.jsx(a.ZP,{children:e.profile})]})]})]}),e.pictures>=1&&r.jsx(p,{username:e.username})]})})}},10474:(e,t,s)=>{"use strict";s.d(t,{HW:()=>n,DM:()=>x,o0:()=>o,o_:()=>i,Mb:()=>c,xj:()=>d,_4:()=>u,Ty:()=>f,ZG:()=>h,TW:()=>m,P9:()=>p,Mg:()=>g,_r:()=>r,NP:()=>a,Tm:()=>l});let r=150,a=6e4*new Date().getTimezoneOffset(),n={"image/jpeg":".jpg","image/png":".png","image/heic":".heic"},l=[8.55,47.38],o=4,i=14,c=864e5,d=6048e5,u=314496e5,h="#8e44ad",m="#27ae60",f="https://travel-api.kupfer.es/images/pictures/ph.png",x={whiteText:"#eee",darkText:"#333"},p="/",g="/dashboard"},54476:(e,t,s)=>{"use strict";s.r(t),s.d(t,{EditSelfieContextWrapper:()=>u});var r=s(10326),a=s(17577),n=s(11220),l=s(16254),o=s(69312);let i=e=>e.me.img||e.lc.img?{me:!!e.me.img,lc:!!e.lc.img}:void 0,c=e=>Math.abs(e.lat)+Math.abs(e.lng)>0,d=(e,t)=>e&&c(t)?[(0,n.Ww)({...t,active_hash:t.hash},{...e,force:!0})]:[],u=({children:e,initialData:t})=>{let[s,u]=(0,a.useState)(t),h=(0,a.useMemo)(()=>i(s.images),[s.images.me,s.images.lc]),m=(0,a.useMemo)(()=>c(s.selfie),[s.selfie.lat,s.selfie.lng]),f=(0,a.useMemo)(()=>d(h,s.selfie),[s.selfie.lat,s.selfie.lng,h]),[x,p]=(0,a.useState)({}),g=(0,a.useCallback)(e=>{let t=l.iW.safeParse({...s.selfie,...e});t.success?p({}):p((0,n.Uo)(t.error.issues)),u(t=>({...t,selfie:{...t.selfie,...e}}))},[s]),v=(0,a.useMemo)(()=>({data:s,setData:u,setSelfieData:g,errors:x,setErrors:p,hash:s.selfie.hash,hasImages:h,hasLocation:m,markers:f,_insideContext_:!0}),[s,f]);return r.jsx(o.EditSelfieContext.Provider,{value:v,children:e})}},56299:(e,t,s)=>{"use strict";s.r(t),s.d(t,{JwtTokenContextWrapper:()=>d});var r=s(10326),a=s(66562),n=s(35047),l=s(17577),o=s(85999),i=s(11220),c=s(90572);let d=({children:e,contextData:t})=>{let s=a.Z.get("token")??null,[d,u]=(0,l.useState)(t.jwt),[h,m]=(0,l.useState)(t.user),f=(0,n.useRouter)(),x=(0,l.useCallback)((e,t=!1)=>{t||!h&&e?m((0,i.JM)(e)):h&&!e&&m(null)},[h]),p=(0,l.useCallback)(e=>{e?a.Z.set("token",e):a.Z.remove("token"),u(e),x(e,!0)},[x]),g=(0,l.useCallback)(e=>(0,i.Cx)(e,d).catch(e=>{throw 401===e.status&&f.push("/auth/logout"+(0,i.L7)({status:e.status})),413===e.status&&o.toast.error("file size too big"),e}),[d]),v=(0,l.useMemo)(()=>({jwt:d,setJwt:p,setUser:m,user:h,api:g,isAuthed:!!h,isAdmin:h?.id===1,_insideContext_:!0}),[d,h,g,p]);return(0,l.useEffect)(()=>{x(s)},[s]),r.jsx(c.JwtTokenContext.Provider,{value:v,children:e})}},59020:(e,t,s)=>{"use strict";s.r(t),s.d(t,{NotificationsWrapper:()=>c});var r=s(10326),a=s(17577),n=s(85999),l=s(11220),o=s(90572),i=s(1001);let c=({children:e})=>{let{api:t,jwt:s}=(0,o.useJwtTokenContext)(),[c,d]=(0,a.useState)(10),[u,h]=(0,a.useState)([]),[m,f]=(0,a.useState)(0),x=e=>{h(t=>[...t.map(t=>({...t,seen:t.id===e?new Date().toISOString():t.seen}))]),f(e=>Math.max(0,(e??0)-1)),g(e,!0)},p=e=>{h(t=>[...t.map(t=>({...t,seen:t.id===e?null:t.seen}))]),f(e=>(e??0)+1),g(e,!1)},g=(e,s)=>{t({url:"/api/notifications/mark",body:{unread:Number(!s),id:e}}).then(l.xO).then(e=>{f(e.unread),v()}).catch(e=>{console.error(e),n.toast.error(String(e))})},v=e=>{t({url:`/api/notifications?limit=${c}`,signal:e}).then(l.xO).then(e=>{h(e.notifications),f(e.unread)})},j=(0,a.useMemo)(()=>({notifications:u,markAsUnead:p,markAsRead:x,unread:m,loadMore:()=>d(e=>e+10),_insideContext_:!0}),[u,m]);return(0,a.useEffect)(()=>{if(!s)return;let e=new AbortController,t=setTimeout(()=>v(e.signal),1e3),r=setInterval(()=>v(e.signal),2e4);return()=>{e.abort(),clearTimeout(t),clearInterval(r)}},[s,c]),r.jsx(i.NotificationsContext.Provider,{value:j,children:e})}},69312:(e,t,s)=>{"use strict";s.r(t),s.d(t,{EditSelfieContext:()=>a,useEditSelfieContext:()=>n});var r=s(17577);let a=(0,r.createContext)({data:{},setData:()=>null,setSelfieData:()=>null,errors:{},setErrors:()=>null,hash:"",hasImages:void 0,hasLocation:!1,markers:[],_insideContext_:!1}),n=()=>{let e=(0,r.useContext)(a);if(!e._insideContext_)throw Error("`useEditSelfieContext` must be used inside of `EditSelfieContext`.");return e}},16106:(e,t,s)=>{"use strict";s.d(t,{Rv:()=>r.useJwtTokenContext,dV:()=>a.useEditSelfieContext,lR:()=>n.useNotificationsContext,qF:()=>l.NotificationsWrapper});var r=s(90572);s(56299);var a=s(69312);s(54476);var n=s(1001),l=s(59020)},90572:(e,t,s)=>{"use strict";s.r(t),s.d(t,{JwtTokenContext:()=>a,useJwtTokenContext:()=>n});var r=s(17577);let a=(0,r.createContext)({jwt:null,setJwt:()=>null,user:null,setUser:()=>null,isAdmin:!1,isAuthed:!1,api:Promise.resolve,_insideContext_:!1}),n=e=>{let t=(0,r.useContext)(a);if(!t._insideContext_)throw Error("`useJwtTokenContext` must be used inside of `JwtTokenContext`.");return e?.redirect&&!t.isAuthed&&t.jwt,t}},1001:(e,t,s)=>{"use strict";s.r(t),s.d(t,{NotificationsContext:()=>a,useNotificationsContext:()=>n});var r=s(17577);let a=(0,r.createContext)({notifications:[],markAsRead:()=>null,markAsUnead:()=>null,loadMore:()=>null,unread:void 0,_insideContext_:!1}),n=()=>{let e=(0,r.useContext)(a);if(!e._insideContext_)throw Error("`useNotificationsContext` must be used inside of `NotificationsContext`.");return e}},29466:(e,t,s)=>{"use strict";s.d(t,{R:()=>a,T:()=>n});var r=s(17577);let a=(0,r.createContext)({selfie:{},prev:null,next:null,exists:!1,loadSelfie:()=>null,_insideContext_:!1}),n=()=>{let e=(0,r.useContext)(a);if(!e._insideContext_)throw Error("`useSingleSelfieContext` must be used inside of `SingleSelfieContext`.");return e}},11220:(e,t,s)=>{"use strict";s.d(t,{vQ:()=>a,Uo:()=>n,gw:()=>l,G0:()=>C,p6:()=>b,Cx:()=>o,r7:()=>R,JM:()=>c,ZE:()=>j,jA:()=>p,Ij:()=>m,ZP:()=>N,gY:()=>w,xO:()=>y,kb:()=>d,HP:()=>g,w6:()=>_,OH:()=>M,t6:()=>F,Jm:()=>O,Jj:()=>k,iQ:()=>D,qH:()=>f,Ww:()=>T,SH:()=>z,Sy:()=>P,L7:()=>v});var r=s(85999);let a=(e,t,s)=>{navigator.clipboard.writeText(e).then(()=>{s&&(0,r.toast)(s),t?.()})},n=(e,t=!1)=>{let s={};return e.forEach(e=>{let t;let r=s;e.path.forEach((s,a)=>{"string"==typeof s?(t=[],r[s]=r[s]??t):"number"==typeof s&&(t={},r[s]=r[s]??t);let n=a===e.path.length-1?e.message:void 0;n?r[s]=n:r=r[s]})}),t&&console.error(s),s},l=(e,t=50)=>setTimeout(e,t),o=({method:e="POST",body:t,url:s="/api/selfies",contentType:r="application/x-www-form-urlencoded",signal:a,cache:n,cacheTags:l=[]},o=null)=>fetch(`https://travel-api.kupfer.es${s}`,{signal:a,next:{cache:n,tags:l},method:e??"POST",headers:{...!1===r?{}:{"Content-Type":r},...o?{Authorization:`Bearer ${o}`}:{}},body:t?t instanceof FormData?t:new URLSearchParams(t).toString():void 0,credentials:"include"}).then(e=>{let t=e.status,s=e.ok;return e.json().then(e=>{if(s)return e.status=t,e;if(e)throw{...e,status:t};throw{success:0,status:t,responseData:e}})});var i=s(18201);let c=e=>e?i.o(e)?.data??null:null,d=(e="")=>{let t=()=>Math.floor((1+Math.random())*65536).toString(16).substring(1);return`${e}${t()}-${t()}`};var u=s(48029),h=s.n(u);let m=e=>h()("has-loading-mask",{"is-loading-mask":e.loading},{"cursor-wait":e.fetching},{"has-spinner":e.spinner}),f=e=>void 0===e?"":x(e.selfies.length,!!e.more),x=(e,t=!1)=>void 0===e?"":1===e?"(1 result)":`(${e}${t?"+":""} results)`,p=e=>Array.isArray(e)?e[e.length-1]:e,g=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),v=e=>{let t=Object.keys(e);if(!(Object.values(e).filter(Boolean).length>0))return"";let s=[];for(let r=0,a=t.length;r<a;++r)s.push(`${encodeURIComponent(t[r])}=${encodeURIComponent(e[t[r]])}`);return"?"+s.join("&")},j=()=>Math.round(+new Date/1e4),y=e=>{if(e.success)return e.responseData;throw console.error("UNSUCCESSFUL",e),e.responseData},w=(e,t)=>`${e} ${t[Number(1!==e)]}`,b=(e,t=!1)=>{let s=e=>e.toString().padStart(2,"0"),r=s(e.getHours()),a=s(e.getMinutes()),n=s(e.getDate()),l=s(e.getMonth()+1),o=e.getFullYear();return t||e.getHours()+e.getMinutes()===0?`${n}-${l}-${o}`:`${r}:${a} ${n}-${l}-${o}`};var A=s(42459),S=s(10474);let N=e=>{let t=e;if("string"==typeof e&&(t=new Date(+new Date(e)-S.NP)),isNaN(t)&&(t=new Date(e)),isNaN(t))throw Error(`Invalid date! "${String(e)}"`);return t},E="date-locale";(0,A.z2)(E,(e,t,s=0)=>{if(1e3*s<S.Mb){let e=+new Date;if(new Date().getDate()===new Date(e-(s??0)).getDate())return["today","today"]}return[["today","today"],["today","today"],["today","today"],["today","today"],["recently","today"],["recently","recently"],["yesterday","tomorrow"],["%s days ago","in %s days"],["1 week ago","in 1 week"],["%s weeks ago","in %s weeks"],["1 month ago","in 1 month"],["%s months ago","in %s months"],["1 year ago","in 1 year"],["%s years ago","in %s years"]][t]});let P=(e,t=!1)=>(0,A.WU)(N(e),t?E:void 0),_=(e,t,s=1)=>{let r=[];void 0===t&&(t=e,e=0);for(let a=e;a<t;a+=s)r.push(a);return r},C=(e,t,s)=>{if(prompt("Type delete to continue")?.toLowerCase()==="delete"){let a=e({method:"DELETE",url:`/api/selfie/delete/${t.hash}`}).then(y);r.toast.promise(a,{success:e=>(s(e),`${t.name} Deleted!`),error:e=>(console.error(e),String(e))})}},D=(e,t=!1)=>`https://travel-api.kupfer.es/images/pictures/uploads/${e.hash}/${t?"mini_":""}me.jpg`,k=(e,t=!1)=>`https://travel-api.kupfer.es/images/pictures/uploads/${e.hash}/${t?"mini_":""}lc.jpg`,O=e=>`https://travel-api.kupfer.es/images/pictures/uploads/${e.hash}/cp.jpg`,z=(e,t="me")=>("me"===t?e.me_brightness:e.lc_brightness)<120?S.DM.whiteText:S.DM.darkText,Z=(e,t)=>t?"edit"===t?`/edit/${e}`:`/s/${e}`:"#",T=(e,t={})=>{t.lc=t.lc??!0,t.me=t.me??!0,t.url=t.url??void 0;let s=t.force?`?t=${+new Date}`:"",r="<div class='empty-div'>";return r+=`<a href="${Z(e.active_hash,t.url)}"`,t.me&&t.lc?r+=` class="${h()("rounded-pin-double",{openable:!!t.url})}" >
      <span class="rounded-pin-double-one"><img src="${D(e,!0)+s}"/></span>
      <span class="rounded-pin-double-two"><img src="${k(e,!0)+s}"/></span>
    </a>`:(r+=` class="${h()("rounded-pin",{openable:!!t.url})}"`,t.me?r+=` style="background-image: url('${D(e,!0)+s}')" ></a>`:t.lc?r+=` style="background-image: url('${k(e,!0)+s}')" ></a>`:r+=">(none)</a>"),r+="</div>",{lat:e.lat,lng:e.lng,icon:r}},M=(e,t)=>`linear-gradient(0.25turn,rgb(${e}),rgb(${t}))`,F=e=>`0 1px 60px 20px rgb(${e})`,R=e=>`(${e.lat}, ${e.lng})`},83164:(e,t,s)=>{"use strict";s.d(t,{B:()=>a}),s(15424);var r=s(46242),a=(0,r.$)("d9e397464a7b483fdb64e6b1b2077a5960e840e0");(0,r.$)("a07630e77e02637849043dfe92df4063862c46c7")},16254:(e,t,s)=>{"use strict";s.d(t,{iW:()=>o,L4:()=>l});var r=s(27256);let a=r.z.enum(["menu","top"]),n=r.z.union([r.z.literal(0),r.z.literal(1),r.z.literal(2)]),l=r.z.object({bell_position:a,email:r.z.string().email(),name:r.z.string().min(5),short_desc:r.z.string().min(5),profile_pic:r.z.string().min(1),gender:n,username:r.z.string().min(4),password:r.z.string().min(8).optional(),confirm:r.z.string().min(8).optional()}).superRefine(({confirm:e,password:t},s)=>{e!==t&&s.addIssue({code:"custom",message:"the passwords do not match",path:["confirm"]})}),o=r.z.object({title:r.z.string().min(5,"Title must be at least 5 characters long"),subtitle:r.z.string().min(10,"Subtitle must be between 5 and 100 characters long").max(100,"Subtitle must be between 5 and 100 characters long"),date:r.z.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be in yyyy-mm-dd format"),place:r.z.string().min(1,"Place must not be empty"),lat:r.z.number().refine(e=>0!==e,{message:"Latitude cannot be 0"}),lng:r.z.number().refine(e=>0!==e,{message:"Longitude cannot be 0"}),description:r.z.string(),url:r.z.string(),hash:r.z.string(),visible:r.z.boolean(),draft:r.z.boolean()})},79109:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j,metadata:()=>g});var r=s(19510);s(5023);var a=s(63401),n=s(71615),l=s(20756),o=s.n(l),i=s(68678),c=s(29098),d=s(68570);let u=(0,d.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/shadcn/toast/toaster.tsx`),{__esModule:h,$$typeof:m}=u;u.default;let f=(0,d.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/shadcn/toast/toaster.tsx#Toaster`);var x=s(55407),p=s(60214);let g={title:"geonaut",description:"a unique travel blog"},v=async()=>{let e=n.cookies().get("token")?.value??null,t=(0,p.JM)(e);return{jwt:e,user:t,isAdmin:t?.username==="nico",isAuthed:!!t}};async function j({children:e}){let t=await v(),s=n.cookies().get("theme")?.value;return r.jsx("html",{lang:"en",suppressHydrationWarning:!0,className:s,children:r.jsx("body",{className:"fill-screen",children:(0,r.jsxs)(a.CssVarsProvider,{defaultMode:s??"system",children:[r.jsx(c.Ju,{}),r.jsx(o(),{showSpinner:!1}),(0,r.jsxs)(x.Rs,{contextData:t,children:[r.jsx(i.b4,{}),e,r.jsx(f,{})]}),r.jsx(c.$_,{})]})})})}},11930:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(19510),a=s(29098);function n(){return r.jsx(a.h2,{})}},1635:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>i,saveEditSelfie:()=>o});var r=s(27745);s(26461);var a=s(70260),n=s(6166),l=s(85723);let o=(0,r.registerServerReference)("bdfee48ae750ffa93f9a762ed393c43dfbf10d0a",i);async function i(e){return await (0,n.serverFetch)({url:"/api/selfie/save-edit",body:e}).then(t=>((0,a.purgeCache)([e.hash]),t))}(0,l.ensureServerEntryExports)([o]),(0,r.registerServerReference)("e0452359b773ffa19b2ee032affea0c6869bfe57",o)},29098:(e,t,s)=>{"use strict";s.d(t,{Cq:()=>c,$_:()=>w,J7:()=>C,h2:()=>y,Ju:()=>N});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/AlertDialog.tsx`),{__esModule:n,$$typeof:l}=a;a.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/AlertDialog.tsx#AlertDialogModal`);var o=s(19510),i=s(63401);let c=({children:e})=>o.jsx(i.Sheet,{sx:{marginX:"auto",minHeight:"100vh",display:"flex",flexDirection:"column",background:"transparent",paddingY:"var(--header-height)",position:"relative",width:{lg:1e3,md:"88vw",xs:"92vw"},my:8,"& > :not([hidden]) ~ :not([hidden])":{marginTop:24}},children:e});s(67815);let d=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/CopyToClipboard.tsx`),{__esModule:u,$$typeof:h}=d;d.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/CopyToClipboard.tsx#CopyToClipboard`);let m=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/CopyPath.tsx`),{__esModule:f,$$typeof:x}=m;m.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/CopyPath.tsx#CopyPath`);var p=s(17710);let g={src:"/_next/static/media/logo.4290582f.png",height:238,width:238,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAb1BMVEUzldsmsV80lt40m9Iot2EqgMQpk5wpgbpMaXEwk8wzo8cxt6MzmdExr6ooi6EntF4plpIojJ4mrGAopHspjawtrHgztbApp3swxIcpiK8vyYIu0W0zmdspmJAyv58qvWM4pugu0G8rnZ8rpJM2s8uwJAtaAAAAHXRSTlP+ouX5I/7n/gAjpOLp/v7h5aP54aAiov3m6aLmo98/8JEAAAAJcEhZcwACTo0AAk6NAUB6lrwAAABFSURBVHicBcEHAoAgDASwA4G27r1Z6v/faAI2g6tLYZjusUiVgXqJUIQVPRGhyTucby1CvjDH0QPfCZnihqQFvKhD38I/eHgDm+Zax+wAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8};var v=s(2907),j=s(85116);let y=({headerType:e="title",selfies:t=3})=>(0,o.jsxs)("div",{className:"selfie-list",children:["title"===e?o.jsx(v.M5,{sticky:!0,header:o.jsx(p.default,{src:g,width:60,height:60,alt:"Logo",className:"animate-pulse"})}):(0,o.jsxs)("div",{className:"flex flex-col space-y-4 justify-center my-48",children:[o.jsx("div",{className:"fric justify-center",children:o.jsx(i.Skeleton,{animation:"wave",variant:"text",level:"h1",sx:{width:200}})}),(0,o.jsxs)("div",{className:"fric space-x-8 w-full",children:[o.jsx(i.Skeleton,{animation:"wave",variant:"circular",width:128,height:128,sx:{flexShrink:0}}),(0,o.jsxs)("div",{className:"flex flex-col space-y-4 w-full",children:[(0,o.jsxs)("div",{className:"fric justify-between",children:[o.jsx(i.Skeleton,{animation:"wave",variant:"text",sx:{width:150}}),o.jsx(i.Skeleton,{animation:"wave",variant:"text",sx:{width:150}}),o.jsx(i.Skeleton,{animation:"wave",variant:"text",sx:{width:150}})]}),(0,o.jsxs)(i.Typography,{children:[o.jsx(i.Skeleton,{animation:"wave",variant:"text",level:"body-lg",sx:{width:"100%"}})," ",o.jsx(i.Skeleton,{animation:"wave",variant:"text",sx:{width:"100%"}})]})]})]})]}),Array.from(Array(t).keys()).map((e,t)=>o.jsx(j.WV,{},t))]}),w=()=>o.jsx("a",{href:"https://kupfer.es",target:"_blank",rel:"noreferrer",className:"fixed bottom-1 right-1 text-xs text-gray-400 opacity-30 hover:opacity-100 transition-opacity",children:"made with ❤️ nico kupfer"}),b=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/SystemModeColorCookie.tsx`),{__esModule:A,$$typeof:S}=b;b.default;let N=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/SystemModeColorCookie.tsx#SystemModeColorCookie`),E=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/history-map/HistoryMap.tsx`),{__esModule:P,$$typeof:_}=E;E.default;let C=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/history-map/HistoryMap.tsx#HistoryMap`),D=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/map-viewer/MapViewer.tsx`),{__esModule:k,$$typeof:O}=D;D.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/map-viewer/MapViewer.tsx#MapViewer`);let z=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/search/SearchEverywhere.tsx`),{__esModule:Z,$$typeof:T}=z;z.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/generic/search/SearchEverywhere.tsx#SearchEverywhere`)},2907:(e,t,s)=>{"use strict";s.d(t,{b4:()=>o,M5:()=>h});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/header/HeaderAndDrawer.tsx`),{__esModule:n,$$typeof:l}=a;a.default;let o=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/header/HeaderAndDrawer.tsx#HeaderAndDrawer`);var i=s(19510);s(70822);var c=s(67815),d=s.n(c),u=s(63401);let h=({header:e,small:t=!1,sticky:s})=>i.jsx("div",{className:d()("top-2 w-full fric dark:text-white justify-center z-[10]",{sticky:s},t?"my-10":"my-[25vh]"),children:"string"==typeof e?i.jsx(u.Typography,{level:"h1",children:e}):e})},68678:(e,t,s)=>{"use strict";s.d(t,{Km:()=>m,yA:()=>g,b4:()=>a.b4,F0:()=>r.F0,WV:()=>r.WV,Db:()=>r.Db,M5:()=>a.M5,To:()=>c});var r=s(85116),a=s(2907),n=s(68570);let l=(0,n.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/user/UserPageHeader.tsx`),{__esModule:o,$$typeof:i}=l;l.default;let c=(0,n.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/user/UserPageHeader.tsx#UserPageHeader`);var d=s(19510),u=s(63401),h=s(57371);let m=({children:e,orElse:t,title:s})=>(0,d.jsxs)("div",{className:"grid place-content-center mt-[var(--header-height)] fill-screen",children:[(0,d.jsxs)(u.Card,{variant:"outlined",sx:{maxHeight:"max-content",minWidth:384},children:[d.jsx(u.Typography,{level:"h3",children:s}),e]}),t&&(0,d.jsxs)("span",{className:"text-sm relative mt-4 fric space-x-2 opacity-50 hover:opacity-100 transition-opacity",children:[d.jsx("span",{children:t.text[0]}),d.jsx(h.default,{href:t.url,className:"is-link",children:t.text[1]})]})]}),f=(0,n.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/edit-selfie/EditSelfieForm.tsx`),{__esModule:x,$$typeof:p}=f;f.default;let g=(0,n.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/edit-selfie/EditSelfieForm.tsx#EditSelfieForm`)},91823:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>o,fetchComments:()=>l});var r=s(27745);s(26461);var a=s(6166),n=s(85723);let l=(0,r.registerServerReference)("4f35886507c36e4ad4dd50b8e7bea9f60ebddec5",o);async function o(e){return(0,a.serverFetch)({url:"/api/comments/get",body:{selfie:e},cacheTags:["comments",e]}).then(e=>{let t=e.comments;return t.reverse(),t})}(0,n.ensureServerEntryExports)([l]),(0,r.registerServerReference)("b1a41dc2655d851f110a3d69243a3ac2141b1080",l)},85116:(e,t,s)=>{"use strict";s.d(t,{F0:()=>b,WV:()=>z,Db:()=>_});var r=s(19510),a=s(67815),n=s.n(a),l=s(17710),o=s(59889),i=s(60214),c=s(68570);let d=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/edit/EdisSelfieButton.tsx`),{__esModule:u,$$typeof:h}=d;d.default;let m=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/edit/EdisSelfieButton.tsx#EditSelfieButton`),f=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/love/LoveSelfie.tsx`),{__esModule:x,$$typeof:p}=f;f.default;let g=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/love/LoveSelfie.tsx#LoveSelfie`),v=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieHeader.tsx`),{__esModule:j,$$typeof:y}=v;v.default;let w=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieHeader.tsx#SelfieHeader`),b=({className:e="",disabled:t=!1,priority:s=!1,selfie:a})=>(0,r.jsxs)("div",{className:n()("flex flex-col max-w-full",e,{"pointer-events-none select-none":t}),style:{background:(0,i.OH)(a.me_color,a.lc_color),boxShadow:(0,i.t6)(a.me_color)},children:[r.jsx(w,{selfie:a}),(0,r.jsxs)("div",{role:"content",className:"flex flex-col md:flex-row relative",children:[!t&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(g,{selfie:a}),r.jsx(m,{selfie:a})]}),r.jsx(l.default,{src:t?o.Ty:(0,i.iQ)(a),alt:"My image",className:"w-full md:w-1/2",width:1e3,height:750,priority:s}),r.jsx(l.default,{src:t?o.Ty:(0,i.Jj)(a),alt:"Landscape image",className:"w-full md:w-1/2",width:1e3,height:750,priority:s})]})]});var A=s(2907);let S=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieAsyncLoader.tsx`),{__esModule:N,$$typeof:E}=S;S.default;let P=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieAsyncLoader.tsx#SelfiesAsyncLoader`),_=({header:e,initialSelfies:t,fetcher:s,sticky:a=!0})=>r.jsx("div",{className:"selfie-list",children:(0,r.jsxs)(P,{fetcher:s,skip:t.length,children:[r.jsx(A.M5,{sticky:a,header:e}),t.map((e,t)=>r.jsx(b,{selfie:e,priority:t<3},e.id))]})}),C=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/ThatsAllFolks.tsx`),{__esModule:D,$$typeof:k}=C;C.default,(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/ThatsAllFolks.tsx#ThatsAllFolks`);var O=s(63401);let z=({className:e=""})=>(0,r.jsxs)("div",{className:n()("flex flex-col max-w-full border border-solid",e),children:[(0,r.jsxs)("div",{role:"header",className:"flex flex-col md:flex-row md:space-y-0 sm:space-x-0 md:space-x-4 md:fric space-y-2 justify-between p-4",children:[(0,r.jsxs)("div",{className:"flex flex-col md:grow",children:[r.jsx(O.Skeleton,{animation:"wave",variant:"text",level:"h1",sx:{width:"100%"}}),r.jsx(O.Skeleton,{animation:"wave",variant:"text",level:"h2",sx:{width:"100%"}})]}),(0,r.jsxs)("div",{className:"flex flex-col w-72",children:[r.jsx(O.Skeleton,{animation:"wave",variant:"text",sx:{width:"100%"}}),r.jsx(O.Skeleton,{animation:"wave",variant:"text",sx:{width:"100%"}}),r.jsx(O.Skeleton,{animation:"wave",variant:"text",sx:{width:"100%"}})]})]}),(0,r.jsxs)("div",{role:"content",className:"flex flex-col md:flex-row relative md:justify-between",children:[r.jsx(O.AspectRatio,{ratio:"4/3",sx:{width:"49%"},children:r.jsx(O.Skeleton,{animation:"wave",sx:{width:"100%"}})}),r.jsx(O.AspectRatio,{ratio:"4/3",sx:{width:"49%"},children:r.jsx(O.Skeleton,{animation:"wave",sx:{width:"100%"}})})]})]}),Z=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieCardLoader.tsx`),{__esModule:T,$$typeof:M}=Z;Z.default,(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieCardLoader.tsx#SelfieCardLoader`);let F=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieDate.tsx`),{__esModule:R,$$typeof:$}=F;F.default,(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieDate.tsx#SelfieDate`);let U=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieMap.tsx`),{__esModule:L,$$typeof:I}=U;U.default,(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/SelfieMap.tsx#SelfieMap`),s(88155);let Q=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/comments/AddComment.tsx`),{__esModule:H,$$typeof:J}=Q;Q.default,(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/comments/AddComment.tsx#AddComment`),s(57371);let W=(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/comments/CommentList.tsx`),{__esModule:B,$$typeof:G}=W;W.default,(0,c.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/comments/CommentList.tsx#CommentList`)},88155:(e,t,s)=>{"use strict";s.d(t,{U:()=>o});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/one/SingleSelfie.tsx`),{__esModule:n,$$typeof:l}=a;a.default;let o=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/one/SingleSelfie.tsx#SingleSelfie`),i=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/one/SelfiePrevNext.tsx`),{__esModule:c,$$typeof:d}=i;i.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/components/selfies/one/SelfiePrevNext.tsx#SelfiePrevNext`)},69940:(e,t,s)=>{},32950:(e,t,s)=>{"use strict";s.d(t,{MS_PER_DAY:()=>r}),new Date().getTimezoneOffset();let r=864e5},12421:(e,t,s)=>{"use strict";var r=s(32950);s.o(r,"MS_PER_DAY")&&s.d(t,{MS_PER_DAY:function(){return r.MS_PER_DAY}});var a=s(69940);s.o(a,"MS_PER_DAY")&&s.d(t,{MS_PER_DAY:function(){return a.MS_PER_DAY}});var n=s(92921);s.o(n,"MS_PER_DAY")&&s.d(t,{MS_PER_DAY:function(){return n.MS_PER_DAY}})},59889:(e,t,s)=>{"use strict";s.d(t,{Mb:()=>r,Ty:()=>a}),new Date().getTimezoneOffset();let r=864e5,a="https://travel-api.kupfer.es/images/pictures/ph.png"},92921:(e,t,s)=>{},55407:(e,t,s)=>{"use strict";s.d(t,{fd:()=>g,Rs:()=>d});var r=s(68570);let a=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/jwt-token.context.ts`),{__esModule:n,$$typeof:l}=a;a.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/jwt-token.context.ts#JwtTokenContext`),(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/jwt-token.context.ts#useJwtTokenContext`);let o=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/JwtTokenContextWrapper.tsx`),{__esModule:i,$$typeof:c}=o;o.default;let d=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/JwtTokenContextWrapper.tsx#JwtTokenContextWrapper`),u=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/edit-selfie.context.ts`),{__esModule:h,$$typeof:m}=u;u.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/edit-selfie.context.ts#EditSelfieContext`),(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/edit-selfie.context.ts#useEditSelfieContext`);let f=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/EditSelfieContextWrapper.tsx`),{__esModule:x,$$typeof:p}=f;f.default;let g=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/EditSelfieContextWrapper.tsx#EditSelfieContextWrapper`),v=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/notifications.context.ts`),{__esModule:j,$$typeof:y}=v;v.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/notifications.context.ts#NotificationsContext`),(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/notifications.context.ts#useNotificationsContext`);let w=(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/NotificationsWrapper.tsx`),{__esModule:b,$$typeof:A}=w;w.default,(0,r.createProxy)(String.raw`/Users/pulze/Documents/Projects/travel/src/context/NotificationsWrapper.tsx#NotificationsWrapper`)},76567:(e,t,s)=>{"use strict";s.d(t,{dbGetSearchResults:()=>l});var r=s(27745);s(26461);var a=s(63968),n=s(85723);let l=(0,r.registerServerReference)("74e12980f9c479c6ec1020fc79c7d5726b2d0ecf",o);async function o(e,t,s,r){let n=t.toLowerCase(),l="",o={};switch(e){case"selfie":l=`
        SELECT DISTINCT sout.id as ID, 'selfie' as type, '' as username, sout.hash, sout.active_hash, sout.added_on FROM (
          SELECT s.id, s.active_hash, s.hash, s.added_on FROM selfies_with_user s WHERE (s.hash = :q OR s.active_hash = :q)
          UNION
          SELECT s.id, s.active_hash, s.hash, s.added_on FROM selfies_with_user s WHERE LOWER(s.title) LIKE :qAprox OR SOUNDEX(s.title) = SOUNDEX(:q)
          UNION
          SELECT s.id, s.active_hash, s.hash, s.added_on FROM selfies_with_user s WHERE LOWER(s.short_desc) LIKE :qAprox OR SOUNDEX(s.short_desc) = SOUNDEX(:q)
          UNION
          (
            SELECT s.id, s.active_hash, s.hash, s.added_on
            FROM selfies_with_user s
            INNER JOIN selfies ON s.id = selfies.id
            WHERE LOWER(selfies.long_desc) LIKE :qAprox
          )
          ORDER BY added_on DESC
        ) sout
        LIMIT :start, :limit
      `,o={qAprox:`%${n}%`,q:n,start:s,limit:r};break;case"user":l=`
        SELECT 'user' as type, u.username, '' as hash, '' as active_hash, s.added_on
        FROM users u
        LEFT JOIN selfies_added_on s ON u.id = s.user_id
        WHERE u.username LIKE :userQuery
        OR u.name LIKE :userQuery
        GROUP BY u.username, s.added_on, hash, active_hash
        LIMIT :start, :limit
      `,o={userQuery:`${n}%`,start:s,limit:r};break;case"location":l=`
        SELECT 'location' as type, '' as username, s.hash, s.active_hash, s.added_on
        FROM selfies_with_user s
        WHERE s.selfie_place LIKE :qAprox
        LIMIT :start, :limit
      `,o={qAprox:`%${n}%`,start:s,limit:r};break;case"date":{let e=new Date(t);if(isNaN(e.getTime()))return[];l=`
        SELECT 'date' as type, '' as username, s.hash, s.active_hash, s.added_on
        FROM selfies_with_user s
        WHERE MONTH(s.selfie_date) = :month AND YEAR(s.selfie_date) = :year
        LIMIT :start, :limit
      `,o={month:e.getMonth()+1,year:e.getFullYear(),start:s,limit:r};break}default:return[]}let[i,c]=await (0,a.getDbConnection)(),[d]=await i.query(l,o);return c(),d}(0,n.ensureServerEntryExports)([l]),(0,r.registerServerReference)("25f2bfb40dac2074526424eb2cb6700020ab9ad7",l)},33262:(e,t,s)=>{"use strict";s.d(t,{dbGetSelfieByHash:()=>o});var r=s(27745);s(26461);var a=s(16881),n=s(63968),l=s(85723);let o=(0,r.registerServerReference)("351d9bb7d2958034c3a7fb7d8cebf1a0d741e507",i);async function i(e,t=!1,s=!1){let[r,a]=await (0,n.getDbConnection)(),l="",o={hash:e};t?(l=`
      SELECT
        s.*,
        IF(l.user_id = :selfId, 1, 0) AS love,
        IF(f.follower = :selfId, 1, 0) AS following,
        IF(s.user_id = :selfId, 'yes', 'no') AS is_owner,
        'selfie' AS 'type',
        COALESCE(lc.loves, 0) AS loves
      FROM selfies_with_user s
      LEFT JOIN love l ON (s.id = l.selfie_id AND :selfId = l.user_id)
      LEFT JOIN follow f ON s.user_id = f.followed
      LEFT JOIN love_count lc ON lc.selfie_id = s.id
      WHERE s.active_hash = :hash
      LIMIT 1
    `,o.selfId=t):l=`
      SELECT
        s.*,
        0 AS love, 0 AS following, 'no' AS is_owner,
        'selfie' AS 'type',
        COALESCE(lc.loves, 0) AS loves
      FROM selfies_with_user s
      LEFT JOIN users u ON s.user_id = u.id
      LEFT JOIN love_count lc ON lc.selfie_id = s.id
      WHERE s.active_hash = :hash
      LIMIT 1
    `;let[i]=await r.query(l,o);if(a(),0===i.length)return null;let d=i[0];return s&&(d.long_desc=await c(d.id)??""),d}let c=async e=>{let[t,s]=await (0,n.getDbConnection)(),[r]=await t.query("SELECT long_desc FROM selfies WHERE id = ?",[e]);return(s(),0===r.length)?null:(0,a.decode)(r[0]?.long_desc??"")??""};(0,l.ensureServerEntryExports)([o]),(0,r.registerServerReference)("e4af2e0703b305da595db477e8db970b29c70bc0",o)},50150:(e,t,s)=>{"use strict";s.d(t,{dbGetUserAndLastSelfie:()=>l});var r=s(27745);s(26461);var a=s(63968),n=s(85723);let l=(0,r.registerServerReference)("bcf5d49aa02371939177b81983f31d3a830b5f1a",o);async function o(e,t=0){let[s,r]=await (0,a.getDbConnection)(),n="",l={username:e};t?(n=`
      SELECT
        s.*,
        IF(l.user_id = :selfId, 1, 0) AS love,
        IF(f.follower = :selfId, 1, 0) AS following,
        IF(s.user_id = :selfId, 'yes', 'no') AS is_owner,
        'user' AS 'type',
        COALESCE(lc.loves, 0) AS loves
      FROM selfies_with_user s
      INNER JOIN selfies_added_on sao
        ON (sao.user_id = s.user_id) AND (sao.added_on = s.added_on)
      LEFT JOIN love l ON (s.id = l.selfie_id AND :selfId = l.user_id)
      LEFT JOIN follow f ON s.user_id = f.followed
      LEFT JOIN love_count lc ON lc.selfie_id = s.id
      WHERE (s.username = :username)
      LIMIT 1
    `,l.selfId=t):n=`
      SELECT
        s.*,
        0 AS love, 0 AS following, 'no' AS is_owner,
        'user' AS 'type',
        COALESCE(lc.loves, 0) AS loves
      FROM selfies_with_user s
      INNER JOIN selfies_added_on sao
        ON (sao.user_id = s.user_id) AND (sao.added_on = s.added_on)
      LEFT JOIN users u ON s.user_id = u.id
      LEFT JOIN love_count lc ON lc.selfie_id = s.id
      WHERE (s.username = :username)
      LIMIT 1
    `;let[o]=await s.query(n,l);return(r(),0===o.length)?null:o[0]}(0,n.ensureServerEntryExports)([l]),(0,r.registerServerReference)("935a11a6096e0bf8cebae7b3e25c4fbbb42a58f5",l)},63968:(e,t,s)=>{"use strict";s.d(t,{getDbConnection:()=>c});var r=s(27745);s(26461);var a=s(41908),n=s(17770),l=s.n(n),o=s(85723);let i=a.createPool({host:process.env.DB_HOST??"",user:process.env.DB_USER??"",database:process.env.DB_NAME??"",password:process.env.DB_PASS??"",...process.env.DB_PORT?{port:+process.env.DB_PORT}:{},waitForConnections:!0,connectionLimit:10,maxIdle:10,idleTimeout:6e4,queueLimit:0,enableKeepAlive:!0,keepAliveInitialDelay:0,namedPlaceholders:!0}),c=(0,r.registerServerReference)("3b52764d1dd1c23c7073109c963f5a2ac3be4f22",d);async function d(){let e=await i.getConnection();return[e,()=>{i.releaseConnection(e)}]}let u=l()();(0,o.ensureServerEntryExports)([c,u]),(0,r.registerServerReference)("1580697c0a61eac36e49ddce995edcbead0fe99f",c),(0,r.registerServerReference)("9d46e8c7b3176eb5a6e00e3c5105b5c8732ab5d7",u)},60214:(e,t,s)=>{"use strict";s.d(t,{JM:()=>r.JM,OH:()=>i,t6:()=>c,Jj:()=>n,mm:()=>o,iQ:()=>a,v:()=>d,Pr:()=>u,L7:()=>r.L7,bZ:()=>h}),s(51032);var r=s(43137);let a=(e,t=!1)=>`https://travel-api.kupfer.es/images/pictures/uploads/${e.hash}/${t?"mini_":""}me.jpg`,n=(e,t=!1)=>`https://travel-api.kupfer.es/images/pictures/uploads/${e.hash}/${t?"mini_":""}lc.jpg`,l=e=>`https://travel-api.kupfer.es/images/pictures/uploads/${e.hash}/cp.jpg`;s(59889);let o=e=>({title:e.title+" - geonaut",description:e.short_desc,creator:e.name,openGraph:{type:"website",url:`https://travel.kupfer.es/s/${e.active_hash}`,title:e.title,description:e.short_desc,siteName:"geonaut",images:[{url:l(e)}]},twitter:{title:e.title,description:e.short_desc,images:[{url:l(e)}]},other:{"theme-color":`rgb(${e.me_color})`}});s(67815);let i=(e,t)=>`linear-gradient(0.25turn,rgb(${e}),rgb(${t}))`,c=e=>`0 1px 60px 20px rgb(${e})`,d=e=>({hash:e.hash,active_hash:e.hash,title:e.title??"(Not found!)",short_desc:`(There is no selfie with hash ${e.hash})`,id:e.id??-1,username:"(none)",selfie_place:"(nowhere)",lat:0,lng:0,long_desc:"",added_on:new Date(0).toISOString(),edited_on:"",lc_brightness:255,love:0,loves:0,me_brightness:255,possessive:"",selfie_date:"(never)"}),u=(e,t,s)=>({selfies:e,more:e.length===t,title:s}),h=e=>({title:e.name+" - geonaut",description:e.profile,creator:e.username,openGraph:{type:"website",url:`https://travel.kupfer.es/u/${e.username}`,title:e.name+" - geonaut",description:e.profile,siteName:"geonaut",images:[{url:e.avatar}]},twitter:{title:e.name+" - geonaut",description:e.profile,images:[{url:e.avatar}]}})},1064:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>d,getSearchResults:()=>u,searchAll:()=>c});var r=s(27745);s(26461);var a=s(76567),n=s(33262),l=s(50150),o=s(48057),i=s(85723);let c=(0,r.registerServerReference)("5692b1ddfa574de66f333084358053296041dcd1",d);async function d(e){return(await Promise.all([(0,a.dbGetSearchResults)("selfie",e,0,2),(0,a.dbGetSearchResults)("user",e,0,2),(0,a.dbGetSearchResults)("location",e,0,2),(0,a.dbGetSearchResults)("date",e,0,2)])).flat()}async function u(e,t,s,r=0,i=10){let d=await (0,o.getUserFromCookie)();if(!t)return{selfies:[],more:!1};let u=[],h=(u="all"!==e?await (0,a.dbGetSearchResults)(e,t,r,i):await c(t)).length;if(0===h)return{selfies:[],more:!1};if(1===h&&"all"===e){let e=u[0];return""===e.hash?{redirect:`/u/${e.username}`,selfies:[],more:!1}:{redirect:`/s/${e.active_hash}`,selfies:[],more:!1}}if(s)return{redirect:`/search/${encodeURIComponent(t)}`,searchType:u[0].type,selfies:[],more:!1};{let e=await Promise.all(u.map(async e=>"0"===e.hash?await (0,l.dbGetUserAndLastSelfie)(e.username,d?.id??0):await (0,n.dbGetSelfieByHash)(e.hash,d?.id??0)));return{selfies:e.filter(Boolean),more:e.length>=i}}}(0,i.ensureServerEntryExports)([c,u]),(0,r.registerServerReference)("a07630e77e02637849043dfe92df4063862c46c7",c),(0,r.registerServerReference)("d9e397464a7b483fdb64e6b1b2077a5960e840e0",u)},48057:(e,t,s)=>{"use strict";s.d(t,{getUserFromCookie:()=>l});var r=s(27745);s(26461);var a=s(53973),n=s(4018);let l=(0,r.registerServerReference)("6cb4a3b721e382ba6bcd426b329b2bf4d87e5865",o);async function o(){let e=a.cookies().get("token")?.value??null;return(0,n.getUserFromJwt)(e)}},70260:(e,t,s)=>{"use strict";s.d(t,{purgeCache:()=>l});var r=s(27745);s(26461);var a=s(30207),n=s(85723);let l=(0,r.registerServerReference)("0966227f5f2c69c0f2e982dbe1425f9d2032113d",o);async function o(e){e.forEach(e=>(0,a.revalidateTag)(e))}(0,n.ensureServerEntryExports)([l]),(0,r.registerServerReference)("839d6de517cbd74ba0ee5718d9c4a62f867df6e5",l)},6166:(e,t,s)=>{"use strict";s.d(t,{serverFetch:()=>o});var r=s(53973),a=s(74739),n=s(62730),l=s(91511);let o=e=>(0,l.gFetch)(e,r.cookies().get("token")?.value??null).catch(e=>{throw e?.responseData?401===e.status&&(0,a.redirect)("/auth/logout"+(0,n.toQuery)({status:e.status})):console.error("NO RESPONSE DATA",e),e}).then(n.raiseOnError)},83136:(e,t,s)=>{"use strict";s(451)},36144:(e,t,s)=>{},72947:(e,t,s)=>{},91511:(e,t,s)=>{"use strict";s.d(t,{gFetch:()=>r});let r=({method:e="POST",body:t,url:s="/api/selfies",contentType:r="application/x-www-form-urlencoded",signal:a,cache:n,cacheTags:l=[]},o=null)=>fetch(`https://travel-api.kupfer.es${s}`,{signal:a,next:{cache:n,tags:l},method:e??"POST",headers:{...!1===r?{}:{"Content-Type":r},...o?{Authorization:`Bearer ${o}`}:{}},body:t?t instanceof FormData?t:new URLSearchParams(t).toString():void 0,credentials:"include"}).then(e=>{let t=e.status,s=e.ok;return e.json().then(e=>{if(s)return e.status=t,e;if(e)throw{...e,status:t};throw{success:0,status:t,responseData:e}})})},49126:(e,t,s)=>{},70544:(e,t,s)=>{},62730:(e,t,s)=>{"use strict";var r=s(83136);s.o(r,"gFetch")&&s.d(t,{gFetch:function(){return r.gFetch}}),s.o(r,"raiseOnError")&&s.d(t,{raiseOnError:function(){return r.raiseOnError}}),s.o(r,"toQuery")&&s.d(t,{toQuery:function(){return r.toQuery}});var a=s(36144);s.o(a,"gFetch")&&s.d(t,{gFetch:function(){return a.gFetch}}),s.o(a,"raiseOnError")&&s.d(t,{raiseOnError:function(){return a.raiseOnError}}),s.o(a,"toQuery")&&s.d(t,{toQuery:function(){return a.toQuery}});var n=s(72947);s.o(n,"gFetch")&&s.d(t,{gFetch:function(){return n.gFetch}}),s.o(n,"raiseOnError")&&s.d(t,{raiseOnError:function(){return n.raiseOnError}}),s.o(n,"toQuery")&&s.d(t,{toQuery:function(){return n.toQuery}});var l=s(91511);s.o(l,"gFetch")&&s.d(t,{gFetch:function(){return l.gFetch}}),s.o(l,"raiseOnError")&&s.d(t,{raiseOnError:function(){return l.raiseOnError}}),s.o(l,"toQuery")&&s.d(t,{toQuery:function(){return l.toQuery}});var o=s(4018);s.o(o,"gFetch")&&s.d(t,{gFetch:function(){return o.gFetch}}),s.o(o,"raiseOnError")&&s.d(t,{raiseOnError:function(){return o.raiseOnError}}),s.o(o,"toQuery")&&s.d(t,{toQuery:function(){return o.toQuery}});var i=s(7173);s.o(i,"gFetch")&&s.d(t,{gFetch:function(){return i.gFetch}}),s.o(i,"raiseOnError")&&s.d(t,{raiseOnError:function(){return i.raiseOnError}}),s.o(i,"toQuery")&&s.d(t,{toQuery:function(){return i.toQuery}});var c=s(16597);s.o(c,"gFetch")&&s.d(t,{gFetch:function(){return c.gFetch}}),s.o(c,"raiseOnError")&&s.d(t,{raiseOnError:function(){return c.raiseOnError}}),s.o(c,"toQuery")&&s.d(t,{toQuery:function(){return c.toQuery}});var d=s(17661);s.o(d,"gFetch")&&s.d(t,{gFetch:function(){return d.gFetch}}),s.o(d,"raiseOnError")&&s.d(t,{raiseOnError:function(){return d.raiseOnError}}),s.o(d,"toQuery")&&s.d(t,{toQuery:function(){return d.toQuery}});var u=s(92145);s.o(u,"gFetch")&&s.d(t,{gFetch:function(){return u.gFetch}}),s.o(u,"raiseOnError")&&s.d(t,{raiseOnError:function(){return u.raiseOnError}}),s.o(u,"toQuery")&&s.d(t,{toQuery:function(){return u.toQuery}});var h=s(33911);s.o(h,"gFetch")&&s.d(t,{gFetch:function(){return h.gFetch}}),s.o(h,"raiseOnError")&&s.d(t,{raiseOnError:function(){return h.raiseOnError}}),s.o(h,"toQuery")&&s.d(t,{toQuery:function(){return h.toQuery}});var m=s(40874);s.o(m,"gFetch")&&s.d(t,{gFetch:function(){return m.gFetch}}),s.o(m,"raiseOnError")&&s.d(t,{raiseOnError:function(){return m.raiseOnError}}),s.o(m,"toQuery")&&s.d(t,{toQuery:function(){return m.toQuery}});var f=s(70544);s.o(f,"gFetch")&&s.d(t,{gFetch:function(){return f.gFetch}}),s.o(f,"raiseOnError")&&s.d(t,{raiseOnError:function(){return f.raiseOnError}}),s.o(f,"toQuery")&&s.d(t,{toQuery:function(){return f.toQuery}});var x=s(53913);s.o(x,"gFetch")&&s.d(t,{gFetch:function(){return x.gFetch}}),s.o(x,"raiseOnError")&&s.d(t,{raiseOnError:function(){return x.raiseOnError}}),s.o(x,"toQuery")&&s.d(t,{toQuery:function(){return x.toQuery}});var p=s(66081);s.o(p,"gFetch")&&s.d(t,{gFetch:function(){return p.gFetch}}),s.o(p,"raiseOnError")&&s.d(t,{raiseOnError:function(){return p.raiseOnError}}),s.o(p,"toQuery")&&s.d(t,{toQuery:function(){return p.toQuery}});var g=s(49126);s.o(g,"gFetch")&&s.d(t,{gFetch:function(){return g.gFetch}}),s.o(g,"raiseOnError")&&s.d(t,{raiseOnError:function(){return g.raiseOnError}}),s.o(g,"toQuery")&&s.d(t,{toQuery:function(){return g.toQuery}});var v=s(39672);s.o(v,"gFetch")&&s.d(t,{gFetch:function(){return v.gFetch}}),s.o(v,"raiseOnError")&&s.d(t,{raiseOnError:function(){return v.raiseOnError}}),s.o(v,"toQuery")&&s.d(t,{toQuery:function(){return v.toQuery}});var j=s(2914);s.o(j,"gFetch")&&s.d(t,{gFetch:function(){return j.gFetch}}),s.o(j,"raiseOnError")&&s.d(t,{raiseOnError:function(){return j.raiseOnError}}),s.o(j,"toQuery")&&s.d(t,{toQuery:function(){return j.toQuery}});var y=s(61957);s.o(y,"gFetch")&&s.d(t,{gFetch:function(){return y.gFetch}}),s.o(y,"raiseOnError")&&s.d(t,{raiseOnError:function(){return y.raiseOnError}}),s.o(y,"toQuery")&&s.d(t,{toQuery:function(){return y.toQuery}});var w=s(79098);s.o(w,"gFetch")&&s.d(t,{gFetch:function(){return w.gFetch}}),s.o(w,"raiseOnError")&&s.d(t,{raiseOnError:function(){return w.raiseOnError}}),s.o(w,"toQuery")&&s.d(t,{toQuery:function(){return w.toQuery}})},43137:(e,t,s)=>{"use strict";s.d(t,{JM:()=>r.J,xO:()=>n,L7:()=>a}),s(51032);var r=s(76283);s(67815);let a=e=>{let t=Object.keys(e);if(!(Object.values(e).filter(Boolean).length>0))return"";let s=[];for(let r=0,a=t.length;r<a;++r)s.push(`${encodeURIComponent(t[r])}=${encodeURIComponent(e[t[r]])}`);return"?"+s.join("&")},n=e=>{if(e.success)return e.responseData;throw console.error("UNSUCCESSFUL",e),e.responseData};var l=s(70304),o=s(59889);(0,l.z2)("date-locale",(e,t,s=0)=>{if(1e3*s<o.Mb){let e=+new Date;if(new Date().getDate()===new Date(e-(s??0)).getDate())return["today","today"]}return[["today","today"],["today","today"],["today","today"],["today","today"],["recently","today"],["recently","recently"],["yesterday","tomorrow"],["%s days ago","in %s days"],["1 week ago","in 1 week"],["%s weeks ago","in %s weeks"],["1 month ago","in 1 month"],["%s months ago","in %s months"],["1 year ago","in 1 year"],["%s years ago","in %s years"]][t]})},4018:(e,t,s)=>{"use strict";s.d(t,{getUserFromJwt:()=>a});var r=s(78477);let a=e=>e?r.jwtDecode(e)?.data??null:null},76283:(e,t,s)=>{"use strict";s.d(t,{J:()=>a});var r=s(70591);let a=e=>e?r.o(e)?.data??null:null},92145:(e,t,s)=>{},16597:(e,t,s)=>{"use strict";s(89555)},17661:(e,t,s)=>{},2914:(e,t,s)=>{"use strict";s(12421)},66081:(e,t,s)=>{},53913:(e,t,s)=>{"use strict";s.d(t,{raiseOnError:()=>r});let r=e=>{if(e.success)return e.responseData;throw console.error("UNSUCCESSFUL",e),e.responseData}},79098:(e,t,s)=>{},7173:(e,t,s)=>{},33911:(e,t,s)=>{},61957:(e,t,s)=>{},39672:(e,t,s)=>{"use strict";var r=s(99120),a=s(12421);s(2914),(0,r.register)("date-locale",(e,t,s=0)=>{if(1e3*s<a.MS_PER_DAY){let e=+new Date;if(new Date().getDate()===new Date(e-(s??0)).getDate())return["today","today"]}return[["today","today"],["today","today"],["today","today"],["today","today"],["recently","today"],["recently","recently"],["yesterday","tomorrow"],["%s days ago","in %s days"],["1 week ago","in 1 week"],["%s weeks ago","in %s weeks"],["1 month ago","in 1 month"],["%s months ago","in %s months"],["1 year ago","in 1 year"],["%s years ago","in %s years"]][t]})},40874:(e,t,s)=>{"use strict";s.d(t,{toQuery:()=>r});let r=e=>{let t=Object.keys(e);if(!(Object.values(e).filter(Boolean).length>0))return"";let s=[];for(let r=0,a=t.length;r<a;++r)s.push(`${encodeURIComponent(t[r])}=${encodeURIComponent(e[t[r]])}`);return"?"+s.join("&")}},19665:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r={src:"/_next/static/media/thats-all-folks.37880f0f.jpg",height:457,width:883,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAAEAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGWD//EABUQAQEAAAAAAAAAAAAAAAAAABIi/9oACAEBAAEFAlP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDAQE/AX//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAECAQE/AX//xAAVEAEBAAAAAAAAAAAAAAAAAAAAQf/aAAgBAQAGPwKP/8QAGBABAQADAAAAAAAAAAAAAAAAAREAMUH/2gAIAQEAAT8hoUBzWf/aAAwDAQACAAMAAAAQ8//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABgQAQADAQAAAAAAAAAAAAAAAAEAESFh/9oACAEBAAE/EGgYGAt92f/Z",blurWidth:8,blurHeight:4}},16043:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r={src:"/_next/static/media/logo.4290582f.png",height:238,width:238,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAb1BMVEUzldsmsV80lt40m9Iot2EqgMQpk5wpgbpMaXEwk8wzo8cxt6MzmdExr6ooi6EntF4plpIojJ4mrGAopHspjawtrHgztbApp3swxIcpiK8vyYIu0W0zmdspmJAyv58qvWM4pugu0G8rnZ8rpJM2s8uwJAtaAAAAHXRSTlP+ouX5I/7n/gAjpOLp/v7h5aP54aAiov3m6aLmo98/8JEAAAAJcEhZcwACTo0AAk6NAUB6lrwAAABFSURBVHicBcEHAoAgDASwA4G27r1Z6v/faAI2g6tLYZjusUiVgXqJUIQVPRGhyTucby1CvjDH0QPfCZnihqQFvKhD38I/eHgDm+Zax+wAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},5023:()=>{},76433:()=>{},11069:()=>{},70822:()=>{},85654:()=>{}};