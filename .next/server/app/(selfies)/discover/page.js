(()=>{var e={};e.id=227,e.ids=[227],e.modules={62849:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62849,e.exports=t},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},39512:e=>{"use strict";e.exports=require("timers")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},28878:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>f,originalPathname:()=>b,pages:()=>l,routeModule:()=>u,tree:()=>c}),s(51590),s(51895),s(35866),s(79109),s(11930);var r=s(23191),n=s(88716),i=s(37922),a=s.n(i),o=s(95231),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);s.d(t,d);let c=["",{children:["(selfies)",{children:["discover",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,51590)),"/Users/pulze/Documents/Projects/travel/src/app/(selfies)/discover/page.tsx"]}]},{loading:[()=>Promise.resolve().then(s.bind(s,51895)),"/Users/pulze/Documents/Projects/travel/src/app/(selfies)/discover/loading.tsx"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,79109)),"/Users/pulze/Documents/Projects/travel/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,11930)),"/Users/pulze/Documents/Projects/travel/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["/Users/pulze/Documents/Projects/travel/src/app/(selfies)/discover/page.tsx"],b="/(selfies)/discover/page",f={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(selfies)/discover/page",pathname:"/discover",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},28505:(e,t,s)=>{let r={"80065baa979c618e9cef9f19a926065a6806bb7c":()=>Promise.resolve().then(s.bind(s,51590)).then(e=>e.$$ACTION_0),df1535f6b2629a718c452af132e7798bc93f65cd:()=>Promise.resolve().then(s.bind(s,70290)).then(e=>e.dbGetFollowedSelfies),f2dc88a132372190137576e6494aaac5a821d3ae:()=>Promise.resolve().then(s.bind(s,70290)).then(e=>e.$$ACTION_0),"1580697c0a61eac36e49ddce995edcbead0fe99f":()=>Promise.resolve().then(s.bind(s,15e3)).then(e=>e.getDbConnection),"3b52764d1dd1c23c7073109c963f5a2ac3be4f22":()=>Promise.resolve().then(s.bind(s,15e3)).then(e=>e.$$ACTION_0),"9d46e8c7b3176eb5a6e00e3c5105b5c8732ab5d7":()=>Promise.resolve().then(s.bind(s,15e3)).then(e=>e.namedPlaceholders),"6cb4a3b721e382ba6bcd426b329b2bf4d87e5865":()=>Promise.resolve().then(s.bind(s,73919)).then(e=>e.$$ACTION_0)};async function n(e,...t){return(await r[e]()).apply(null,t)}e.exports={"80065baa979c618e9cef9f19a926065a6806bb7c":n.bind(null,"80065baa979c618e9cef9f19a926065a6806bb7c"),df1535f6b2629a718c452af132e7798bc93f65cd:n.bind(null,"df1535f6b2629a718c452af132e7798bc93f65cd"),f2dc88a132372190137576e6494aaac5a821d3ae:n.bind(null,"f2dc88a132372190137576e6494aaac5a821d3ae"),"1580697c0a61eac36e49ddce995edcbead0fe99f":n.bind(null,"1580697c0a61eac36e49ddce995edcbead0fe99f"),"3b52764d1dd1c23c7073109c963f5a2ac3be4f22":n.bind(null,"3b52764d1dd1c23c7073109c963f5a2ac3be4f22"),"9d46e8c7b3176eb5a6e00e3c5105b5c8732ab5d7":n.bind(null,"9d46e8c7b3176eb5a6e00e3c5105b5c8732ab5d7"),"6cb4a3b721e382ba6bcd426b329b2bf4d87e5865":n.bind(null,"6cb4a3b721e382ba6bcd426b329b2bf4d87e5865")}},30324:(e,t,s)=>{let r={"4f35886507c36e4ad4dd50b8e7bea9f60ebddec5":()=>Promise.resolve().then(s.bind(s,91823)).then(e=>e.$$ACTION_0),b1a41dc2655d851f110a3d69243a3ac2141b1080:()=>Promise.resolve().then(s.bind(s,91823)).then(e=>e.fetchComments),"5692b1ddfa574de66f333084358053296041dcd1":()=>Promise.resolve().then(s.bind(s,1064)).then(e=>e.$$ACTION_0),a07630e77e02637849043dfe92df4063862c46c7:()=>Promise.resolve().then(s.bind(s,1064)).then(e=>e.searchAll),d9e397464a7b483fdb64e6b1b2077a5960e840e0:()=>Promise.resolve().then(s.bind(s,1064)).then(e=>e.getSearchResults),"06c3c0885ee10b0d6b95556dbef181c4f6360a14":()=>Promise.resolve().then(s.bind(s,31915)).then(e=>e.publishSelfie),b07d83010229c3b0050b55aca3fc624cc0b9f40b:()=>Promise.resolve().then(s.bind(s,31915)).then(e=>e.$$ACTION_0)};async function n(e,...t){return(await r[e]()).apply(null,t)}e.exports={"4f35886507c36e4ad4dd50b8e7bea9f60ebddec5":n.bind(null,"4f35886507c36e4ad4dd50b8e7bea9f60ebddec5"),b1a41dc2655d851f110a3d69243a3ac2141b1080:n.bind(null,"b1a41dc2655d851f110a3d69243a3ac2141b1080"),"5692b1ddfa574de66f333084358053296041dcd1":n.bind(null,"5692b1ddfa574de66f333084358053296041dcd1"),a07630e77e02637849043dfe92df4063862c46c7:n.bind(null,"a07630e77e02637849043dfe92df4063862c46c7"),d9e397464a7b483fdb64e6b1b2077a5960e840e0:n.bind(null,"d9e397464a7b483fdb64e6b1b2077a5960e840e0"),"06c3c0885ee10b0d6b95556dbef181c4f6360a14":n.bind(null,"06c3c0885ee10b0d6b95556dbef181c4f6360a14"),b07d83010229c3b0050b55aca3fc624cc0b9f40b:n.bind(null,"b07d83010229c3b0050b55aca3fc624cc0b9f40b")}},50610:(e,t,s)=>{Promise.resolve().then(s.bind(s,9131)),Promise.resolve().then(s.t.bind(s,92481,23)),Promise.resolve().then(s.t.bind(s,79404,23)),Promise.resolve().then(s.bind(s,85999)),Promise.resolve().then(s.bind(s,1121)),Promise.resolve().then(s.bind(s,35209)),Promise.resolve().then(s.bind(s,28003)),Promise.resolve().then(s.bind(s,13294)),Promise.resolve().then(s.bind(s,10006)),Promise.resolve().then(s.bind(s,3952)),Promise.resolve().then(s.bind(s,38911)),Promise.resolve().then(s.bind(s,47112)),Promise.resolve().then(s.bind(s,68813)),Promise.resolve().then(s.bind(s,26733)),Promise.resolve().then(s.bind(s,88313)),Promise.resolve().then(s.bind(s,59805)),Promise.resolve().then(s.bind(s,66009)),Promise.resolve().then(s.bind(s,79951)),Promise.resolve().then(s.bind(s,71131))},51895:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(19510),n=s(29098);function i(){return r.jsx(n.h2,{})}},51590:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>b,default:()=>f,metadata:()=>c});var r=s(19510),n=s(24330);s(60166);var i=s(68678),a=s(70290),o=s(60214),d=s(73919);let c={title:"discover - geonaut",description:"latest posts by those you're interested in"};var l=(0,n.j)("80065baa979c618e9cef9f19a926065a6806bb7c",b);async function b(e){let t=await (0,d.getUserFromCookie)(),s=await (0,a.dbGetFollowedSelfies)({selfId:t?.id,skip:e,limit:10});return(0,o.Pr)(s,10,"discover")}async function f(){let e=await l(0);return r.jsx(i.Db,{initialSelfies:e.selfies,header:e.title,fetcher:e.more?l:void 0})}},70290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>o,dbGetFollowedSelfies:()=>a});var r=s(24330);s(60166);var n=s(15e3),i=s(40618);let a=(0,r.j)("f2dc88a132372190137576e6494aaac5a821d3ae",o);async function o({selfId:e=0,skip:t=0,limit:s=10}){let[r,i]=await (0,n.getDbConnection)(),[a,o]=await r.query(`
        SELECT
            'selfie' AS 'type',
            COALESCE (lc.loves, 0) AS loves,
            IF(l.user_id = :selfId, 1, 0) AS love,
            -- IF(f.follower = :selfId, 1, 0) AS following,
            s.*
        FROM
            follow f
        RIGHT JOIN selfies_with_user s ON s.user_id = f.followed
        LEFT JOIN love_count lc ON lc.selfie_id = s.id
        LEFT JOIN love l ON s.id = l.selfie_id AND l.user_id = :selfId

        WHERE
            f.follower = :selfId
      ORDER BY s.added_on DESC LIMIT :start, :limit
      `,{selfId:e,start:t,limit:s});return i(),a}(0,i.h)([a]),(0,r.j)("df1535f6b2629a718c452af132e7798bc93f65cd",a)},15e3:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>b,getDbConnection:()=>l,namedPlaceholders:()=>f});var r=s(24330);s(60166);var n=s(69518),i=s(30001),a=s.n(i),o=s(40618);let d=global;d.dbPool=d.dbPool||n.createPool({host:process.env.DB_HOST??"",user:process.env.DB_USER??"",database:process.env.DB_NAME??"",password:process.env.DB_PASS??"",...process.env.DB_PORT?{port:+process.env.DB_PORT}:{},waitForConnections:!0,connectionLimit:10,maxIdle:10,idleTimeout:6e4,queueLimit:0,enableKeepAlive:!0,keepAliveInitialDelay:0,namedPlaceholders:!0});let c=d.dbPool,l=(0,r.j)("3b52764d1dd1c23c7073109c963f5a2ac3be4f22",b);async function b(){let e=await c.getConnection();return[e,()=>{c.releaseConnection(e),e.release()}]}let f=a()();(0,o.h)([l,f]),(0,r.j)("1580697c0a61eac36e49ddce995edcbead0fe99f",l),(0,r.j)("9d46e8c7b3176eb5a6e00e3c5105b5c8732ab5d7",f)},73919:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$ACTION_0:()=>o,getUserFromCookie:()=>a});var r=s(24330);s(60166);var n=s(71615),i=s(76283);let a=(0,r.j)("6cb4a3b721e382ba6bcd426b329b2bf4d87e5865",o);async function o(){let e=n.cookies().get("token")?.value??null;return(0,i.J)(e)}},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(66621);let n=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,615,842,621,369,617],()=>s(28878));module.exports=r})();